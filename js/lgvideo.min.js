!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).lgVideo=t()}(this,function(){"use strict";var e=function(){return(e=Object.assign||function(e){for(var t,s,n=1,o=arguments.length;n<o;n++)for(s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},n={autoplayFirstVideo:!0,youTubePlayerParams:!1,vimeoPlayerParams:!1,wistiaPlayerParams:!1,gotoNextSlideOnVideoEnd:!0,autoplayVideoOnSlide:!1,videojs:!1,videojsTheme:"",videojsOptions:{}},s="lgHasVideo",o="lgSlideItemLoad",i="lgBeforeSlide",a="lgAfterSlide",r="lgPosterClick",t=function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},c=function(n,s){if(!n.youtube)return"";var o=n.youtube[2]?n.youtube[2].slice(1).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){var n=t.map(decodeURIComponent),s=n[0],o=n[1];return e[s]=o,e},{}):"",i=s||{},a=e(e(e({},{wmode:"opaque",autoplay:0,mute:1,enablejsapi:1}),i),o);return"?"+t(a)};return function(){function l(t){return this.core=t,this.settings=e(e({},n),this.core.settings),this}return l.prototype.init=function(){var e=this;this.core.LGel.on(s+".video",this.onHasVideo.bind(this)),this.core.LGel.on(r+".video",function(){var t=e.core.getSlideItem(e.core.index);e.loadVideoOnPosterClick(t)}),this.core.LGel.on(o+".video",this.onSlideItemLoad.bind(this)),this.core.LGel.on(i+".video",this.onBeforeSlide.bind(this)),this.core.LGel.on(a+".video",this.onAfterSlide.bind(this))},l.prototype.onSlideItemLoad=function(e){var o=this,n=e.detail,s=n.isFirstSlide,t=n.index;this.settings.autoplayFirstVideo&&s&&t===this.core.index&&setTimeout(function(){o.loadAndPlayVideo(t)},200),!s&&this.settings.autoplayVideoOnSlide&&t===this.core.index&&this.loadAndPlayVideo(t)},l.prototype.onHasVideo=function(e){var t=e.detail,n=t.index,s=t.src,o=t.html5Video;t.hasPoster||(this.appendVideos(this.core.getSlideItem(n),{src:s,addClass:"lg-object",index:n,html5Video:o}),this.gotoNextSlideOnVideoEnd(s,n))},l.prototype.onBeforeSlide=function(e){if(this.core.lGalleryOn){var t=e.detail.prevIndex;this.pauseVideo(t)}},l.prototype.onAfterSlide=function(e){var s=this,n=e.detail,t=n.index,o=n.prevIndex,i=this.core.getSlideItem(t);this.settings.autoplayVideoOnSlide&&t!==o&&i.hasClass("lg-complete")&&setTimeout(function(){s.loadAndPlayVideo(t)},100)},l.prototype.loadAndPlayVideo=function(e){var t=this.core.getSlideItem(e);this.core.galleryItems[e].poster?this.loadVideoOnPosterClick(t,!0):this.playVideo(e)},l.prototype.playVideo=function(e){this.controlVideo(e,"play")},l.prototype.pauseVideo=function(e){this.controlVideo(e,"pause")},l.prototype.getVideoHtml=function(e,n,s,o){var a,l,u,h,m,f,g,v,b,j,y,d="",i=this.core.galleryItems[s].__slideVideoInfo||{},_=this.core.galleryItems[s],r=_.title||_.alt,r=r?'title="'+r+'"':"",p=`allowtransparency="true"
            frameborder="0"
            scrolling="no"
            allowfullscreen
            mozallowfullscreen
            webkitallowfullscreen
            oallowfullscreen
            msallowfullscreen`;if(i.youtube)u="lg-youtube"+s,y=c(i,this.settings.youTubePlayerParams),d='<iframe allow="autoplay" id='+u+' class="lg-video-object lg-youtube '+n+'" '+r+' src="'+(e.includes("youtube-nocookie.com")?"//www.youtube-nocookie.com/":"//www.youtube.com/")+"embed/"+(i.youtube[1]+y)+'" '+p+"></iframe>";else if(i.vimeo)u="lg-vimeo"+s,l=function(e,n){if(!n||!n.vimeo)return"";var r,s=n.vimeo[2]||"",o=Object.assign({},{autoplay:0,muted:1},e),i=o&&0!==Object.keys(o).length?t(o):"",a=((n.vimeo[0].split("/").pop()||"").split("?")[0]||"").split("#")[0],c=n.vimeo[1]!==a;return c&&(s=s.replace("/"+a,"")),r=c?"h="+a:"","?"+r+(i=r?"&"+i:i)+("?"==s[0]?"&"+s.slice(1):s||"")}(this.settings.vimeoPlayerParams,i),d='<iframe allow="autoplay" id='+u+' class="lg-video-object lg-vimeo '+n+'" '+r+' src="//player.vimeo.com/video/'+(i.vimeo[1]+l)+'" '+p+"></iframe>";else if(i.wistia)v="lg-wistia"+s,l=(l=t(this.settings.wistiaPlayerParams))?"?"+l:"",d='<iframe allow="autoplay" id="'+v+'" src="//fast.wistia.net/embed/iframe/'+(i.wistia[4]+l)+'" '+r+' class="wistia_embed lg-video-object lg-wistia '+n+'" name="wistia_embed" '+p+"></iframe>";else if(i.html5){for(h="",a=0;a<o.source.length;a++)m=o.source[a].type,b=m?'type="'+m+'"':"",h+='<source src="'+o.source[a].src+'" '+b+">";if(o.tracks){j=function(e){var t="",n=o.tracks[e];Object.keys(n||{}).forEach(function(e){t+=e+'="'+n[e]+'" '}),h+="<track "+t+">"};for(a=0;a<o.tracks.length;a++)j(a)}g="",f=o.attributes||{},Object.keys(f||{}).forEach(function(e){g+=e+'="'+f[e]+'" '}),d='<video class="lg-video-object lg-html5 '+(this.settings.videojs&&this.settings.videojsTheme?this.settings.videojsTheme+" ":"")+" "+(this.settings.videojs?" video-js":"")+'" '+g+`>
                `+h+`
                Your browser does not support HTML5 video.
            </video>`}return d},l.prototype.appendVideos=function(e,t){var n,s,o=this.getVideoHtml(t.src,t.addClass,t.index,t.html5Video);if(e.find(".lg-video-cont").append(o),s=e.find(".lg-video-object").first(),t.html5Video&&s.on("mousedown.lg.video",function(e){e.stopPropagation()}),this.settings.videojs&&(null===(n=this.core.galleryItems[t.index].__slideVideoInfo)||void 0===n?void 0:n.html5))try{return videojs(s.get(),this.settings.videojsOptions)}catch{console.error("lightGallery:- Make sure you have included videojs")}},l.prototype.gotoNextSlideOnVideoEnd=function(e,t){var n=this,s=this.core.getSlideItem(t).find(".lg-video-object").first(),o=this.core.galleryItems[t].__slideVideoInfo||{};if(this.settings.gotoNextSlideOnVideoEnd)if(o.html5)s.on("ended",function(){n.core.goToNextSlide()});else if(o.vimeo)try{new Vimeo.Player(s.get()).on("ended",function(){n.core.goToNextSlide()})}catch{console.error("lightGallery:- Make sure you have included //github.com/vimeo/player.js")}else if(o.wistia)try{window._wq=window._wq||[],window._wq.push({id:s.attr("id"),onReady:function(e){e.bind("end",function(){n.core.goToNextSlide()})}})}catch{console.error("lightGallery:- Make sure you have included //fast.wistia.com/assets/external/E-v1.js")}},l.prototype.controlVideo=function(e,t){var n=this.core.getSlideItem(e).find(".lg-video-object").first(),s=this.core.galleryItems[e].__slideVideoInfo||{};if(n.get())if(s.youtube)try{n.get().contentWindow.postMessage('{"event":"command","func":"'+t+'Video","args":""}',"*")}catch(e){console.error("lightGallery:- "+e)}else if(s.vimeo)try{new Vimeo.Player(n.get())[t]()}catch{console.error("lightGallery:- Make sure you have included //github.com/vimeo/player.js")}else if(s.html5)if(this.settings.videojs)try{videojs(n.get())[t]()}catch{console.error("lightGallery:- Make sure you have included videojs")}else n.get()[t]();else if(s.wistia)try{window._wq=window._wq||[],window._wq.push({id:n.attr("id"),onReady:function(e){e[t]()}})}catch{console.error("lightGallery:- Make sure you have included //fast.wistia.com/assets/external/E-v1.js")}},l.prototype.loadVideoOnPosterClick=function(e,t){if(n=this,e.hasClass("lg-video-loaded"))t&&this.playVideo(this.core.index);else if(e.hasClass("lg-has-video"))this.playVideo(this.core.index);else{e.addClass("lg-has-video");var n,o,r,i=void 0,a=this.core.galleryItems[this.core.index].src,s=this.core.galleryItems[this.core.index].video;s&&(i="string"==typeof s?JSON.parse(s):s),o=this.appendVideos(e,{src:a,addClass:"",index:this.core.index,html5Video:i}),this.gotoNextSlideOnVideoEnd(a,this.core.index),r=e.find(".lg-object").first().get(),e.find(".lg-video-cont").first().append(r),e.addClass("lg-video-loading"),o&&o.ready(function(){o.on("loadedmetadata",function(){n.onVideoLoadAfterPosterClick(e,n.core.index)})}),e.find(".lg-video-object").first().on("load.lg error.lg loadedmetadata.lg",function(){setTimeout(function(){n.onVideoLoadAfterPosterClick(e,n.core.index)},50)})}},l.prototype.onVideoLoadAfterPosterClick=function(e,t){e.addClass("lg-video-loaded"),this.playVideo(t)},l.prototype.destroy=function(){this.core.LGel.off(".lg.video"),this.core.LGel.off(".video")},l}()})