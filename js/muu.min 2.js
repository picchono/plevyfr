!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Muuri=t()}(this,function(){"use strict";var p,_,T,W,U,X,de={},D="function"==typeof Map?new Map:null,b="swap",N="move",M="layoutStart",Ue="layoutEnd",Xe="layoutAbort",ot="remove",$="hideStart",ct="filter",lt="sort",ne="move",se="send",E="beforeSend",ee="receive",ae="beforeReceive",q="dragReleaseEnd",Ot="ontouchstart"in window,we=!!window.PointerEvent,Oe=!!window.navigator.msPointerEnabled,he,xe,Ft,Te,ze,Ge,ye,Le,le,vt,je,_t,Se,Ae,ue,kt,Ee,Rt,Dt,zt;function h(){this._events={},this._queue=[],this._counter=0,this._clearOnEmit=!1}h.prototype.on=function(e,t){if(!this._events||!e||!t)return this;var n=this._events[e];return n||(n=this._events[e]=[]),n.push(t),this},h.prototype.off=function(e,t){if(!this._events||!e||!t)return this;var s,n=this._events[e];if(!n||!n.length)return this;for(;-1!==(s=n.indexOf(t));)n.splice(s,1);return this},h.prototype.clear=function(e){if(!this._events||!e)return this;var t=this._events[e];return t&&(t.length=0,delete this._events[e]),this},h.prototype.emit=function(e){if(!this._events||!e)return this._clearOnEmit=!1,this;if(s=this._events[e],!s||!s.length)return this._clearOnEmit=!1,this;var n,s,i,a,t=this._queue,r=t.length,o=arguments.length-1;o>3&&((i=[]).push.apply(i,arguments),i.shift()),t.push.apply(t,s),this._clearOnEmit&&(s.length=0,this._clearOnEmit=!1),++this._counter;for(n=r,a=t.length;n<a;n++)if(0===o?t[n]():1===o?t[n](arguments[1]):2===o?t[n](arguments[1],arguments[2]):3===o?t[n](arguments[1],arguments[2],arguments[3]):t[n].apply(null,i),!this._events)return this;return--this._counter,this._counter||(t.length=0),this},h.prototype.burst=function(){return this._events?(this._clearOnEmit=!0,this.emit.apply(this,arguments),this):this},h.prototype.countListeners=function(e){if(!this._events)return 0;var t=this._events[e];return t?t.length:0},h.prototype.destroy=function(){return this._events?(this._queue.length=this._counter=0,this._events=null,this):this},U=we?"pointerout":Oe?"MSPointerOut":"";function x(e){U&&(this._dragger=e,this._timeout=null,this._outEvent=null,this._isActive=!1,this._addBehaviour=this._addBehaviour.bind(this),this._removeBehaviour=this._removeBehaviour.bind(this),this._onTimeout=this._onTimeout.bind(this),this._resetData=this._resetData.bind(this),this._onStart=this._onStart.bind(this),this._onOut=this._onOut.bind(this),this._dragger.on("start",this._onStart))}x.prototype._addBehaviour=function(){this._isActive||(this._isActive=!0,this._dragger.on("move",this._resetData),this._dragger.on("cancel",this._removeBehaviour),this._dragger.on("end",this._removeBehaviour),window.addEventListener(U,this._onOut))},x.prototype._removeBehaviour=function(){this._isActive&&(this._dragger.off("move",this._resetData),this._dragger.off("cancel",this._removeBehaviour),this._dragger.off("end",this._removeBehaviour),window.removeEventListener(U,this._onOut),this._resetData(),this._isActive=!1)},x.prototype._resetData=function(){window.clearTimeout(this._timeout),this._timeout=null,this._outEvent=null},x.prototype._onStart=function(e){"mouse"!==e.pointerType&&this._addBehaviour()},x.prototype._onOut=function(e){this._dragger._getTrackedTouch(e)&&(this._resetData(),this._outEvent=e,this._timeout=window.setTimeout(this._onTimeout,100))},x.prototype._onTimeout=function(){var e=this._outEvent;this._resetData(),this._dragger.isActive()&&this._dragger._onCancel(e)},x.prototype.destroy=function(){U&&(this._dragger.off("start",this._onStart),this._removeBehaviour())},he=["","webkit","moz","ms","o","Webkit","Moz","MS","O"],xe={};function pe(e,t){if(n=xe[t]||"",n)return n;for(var n,o=t[0].toUpperCase()+t.slice(1),s=0;s<he.length;){if((n=he[s]?he[s]+o:t)in e)return xe[t]=n,n;++s}return""}function Ht(){var e,t=!1;try{e=Object.defineProperty({},"passive",{get:function(){t=!0}}),window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch{}return t}var ve=window.navigator.userAgent.toLowerCase(),rn=ve.indexOf("edge")>-1,Zt=ve.indexOf("trident")>-1,Wt=ve.indexOf("firefox")>-1,Yt=ve.indexOf("android")>-1,S=!!Ht()&&{passive:!0},Tt="touchAction",ge=pe(document.documentElement.style,Tt);function e(t,n){this._element=t,this._emitter=new h,this._isDestroyed=!1,this._cssProps={},this._touchAction="",this._isActive=!1,this._pointerId=null,this._startTime=0,this._startX=0,this._startY=0,this._currentX=0,this._currentY=0,this._onStart=this._onStart.bind(this),this._onMove=this._onMove.bind(this),this._onCancel=this._onCancel.bind(this),this._onEnd=this._onEnd.bind(this),this._edgeHack=null,(rn||Zt)&&(we||Oe)&&(this._edgeHack=new x(this)),this.setCssProps(n),this._touchAction||this.setTouchAction("auto"),t.addEventListener("dragstart",e._preventDefault,!1),t.addEventListener(e._inputEvents.start,this._onStart,S)}e._pointerEvents={start:"pointerdown",move:"pointermove",cancel:"pointercancel",end:"pointerup"},e._msPointerEvents={start:"MSPointerDown",move:"MSPointerMove",cancel:"MSPointerCancel",end:"MSPointerUp"},e._touchEvents={start:"touchstart",move:"touchmove",cancel:"touchcancel",end:"touchend"},e._mouseEvents={start:"mousedown",move:"mousemove",cancel:"",end:"mouseup"},e._inputEvents=Ot?e._touchEvents:we?e._pointerEvents:Oe?e._msPointerEvents:e._mouseEvents,e._emitter=new h,e._emitterEvents={start:"start",move:"move",end:"end",cancel:"cancel"},e._activeInstances=[],e._preventDefault=function(e){e.preventDefault&&!1!==e.cancelable&&e.preventDefault()},e._activateInstance=function(t){e._activeInstances.indexOf(t)>-1||(e._activeInstances.push(t),e._emitter.on(e._emitterEvents.move,t._onMove),e._emitter.on(e._emitterEvents.cancel,t._onCancel),e._emitter.on(e._emitterEvents.end,t._onEnd),1===e._activeInstances.length&&e._bindListeners())},e._deactivateInstance=function(t){var n=e._activeInstances.indexOf(t);-1!==n&&(e._activeInstances.splice(n,1),e._emitter.off(e._emitterEvents.move,t._onMove),e._emitter.off(e._emitterEvents.cancel,t._onCancel),e._emitter.off(e._emitterEvents.end,t._onEnd),e._activeInstances.length||e._unbindListeners())},e._bindListeners=function(){window.addEventListener(e._inputEvents.move,e._onMove,S),window.addEventListener(e._inputEvents.end,e._onEnd,S),e._inputEvents.cancel&&window.addEventListener(e._inputEvents.cancel,e._onCancel,S)},e._unbindListeners=function(){window.removeEventListener(e._inputEvents.move,e._onMove,S),window.removeEventListener(e._inputEvents.end,e._onEnd,S),e._inputEvents.cancel&&window.removeEventListener(e._inputEvents.cancel,e._onCancel,S)},e._getEventPointerId=function(e){return"number"==typeof e.pointerId?e.pointerId:e.changedTouches?e.changedTouches[0]?e.changedTouches[0].identifier:null:1},e._getTouchById=function(e,t){if("number"==typeof e.pointerId)return e.pointerId===t?e:null;if(e.changedTouches){for(var n=0;n<e.changedTouches.length;n++)if(e.changedTouches[n].identifier===t)return e.changedTouches[n];return null}return e},e._onMove=function(t){e._emitter.emit(e._emitterEvents.move,t)},e._onCancel=function(t){e._emitter.emit(e._emitterEvents.cancel,t)},e._onEnd=function(t){e._emitter.emit(e._emitterEvents.end,t)},e.prototype._reset=function(){this._pointerId=null,this._startTime=0,this._startX=0,this._startY=0,this._currentX=0,this._currentY=0,this._isActive=!1,e._deactivateInstance(this)},e.prototype._createEvent=function(t,n){var s=this._getTrackedTouch(n);return{type:t,srcEvent:n,distance:this.getDistance(),deltaX:this.getDeltaX(),deltaY:this.getDeltaY(),deltaTime:t===e._emitterEvents.start?0:this.getDeltaTime(),isFirst:t===e._emitterEvents.start,isFinal:t===e._emitterEvents.end||t===e._emitterEvents.cancel,pointerType:n.pointerType||(n.touches?"touch":"mouse"),identifier:this._pointerId,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY,target:s.target}},e.prototype._emit=function(e,t){this._emitter.emit(e,this._createEvent(e,t))},e.prototype._getTrackedTouch=function(t){return null===this._pointerId?null:e._getTouchById(t,this._pointerId)},e.prototype._onStart=function(t){if(!this._isDestroyed&&null===this._pointerId&&(this._pointerId=e._getEventPointerId(t),null!==this._pointerId)){var n=this._getTrackedTouch(t);this._startX=this._currentX=n.clientX,this._startY=this._currentY=n.clientY,this._startTime=Date.now(),this._isActive=!0,this._emit(e._emitterEvents.start,t),this._isActive&&e._activateInstance(this)}},e.prototype._onMove=function(t){var n=this._getTrackedTouch(t);n&&(this._currentX=n.clientX,this._currentY=n.clientY,this._emit(e._emitterEvents.move,t))},e.prototype._onCancel=function(t){this._getTrackedTouch(t)&&(this._emit(e._emitterEvents.cancel,t),this._reset())},e.prototype._onEnd=function(t){this._getTrackedTouch(t)&&(this._emit(e._emitterEvents.end,t),this._reset())},e.prototype.isActive=function(){return this._isActive},e.prototype.setTouchAction=function(t){this._touchAction=t,ge&&(this._cssProps[ge]="",this._element.style[ge]=t),Ot&&(this._element.removeEventListener(e._touchEvents.start,e._preventDefault,!0),(this._element.style[ge]!==t||Wt&&Yt)&&this._element.addEventListener(e._touchEvents.start,e._preventDefault,!0))},e.prototype.setCssProps=function(e){if(e){var t,s,n=this._cssProps,o=this._element;for(t in n)o.style[t]=n[t],delete n[t];for(t in e)e[t]&&(t!==Tt?(s=pe(o.style,t))&&(n[s]="",o.style[s]=e[t]):this.setTouchAction(e[t]))}},e.prototype.getDeltaX=function(){return this._currentX-this._startX},e.prototype.getDeltaY=function(){return this._currentY-this._startY},e.prototype.getDistance=function(){var e=this.getDeltaX(),t=this.getDeltaY();return Math.sqrt(e*e+t*t)},e.prototype.getDeltaTime=function(){return this._startTime?Date.now()-this._startTime:0},e.prototype.on=function(e,t){this._emitter.on(e,t)},e.prototype.off=function(e,t){this._emitter.off(e,t)},e.prototype.destroy=function(){if(!this._isDestroyed){var n,t=this._element;for(n in this._edgeHack&&this._edgeHack.destroy(),this._reset(),this._emitter.destroy(),t.removeEventListener(e._inputEvents.start,this._onStart,S),t.removeEventListener("dragstart",e._preventDefault,!1),t.removeEventListener(e._touchEvents.start,e._preventDefault,!0),this._cssProps)t.style[n]=this._cssProps[n],delete this._cssProps[n];this._element=null,this._isDestroyed=!0}},Ft=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return this.setTimeout(function(){e(Date.now())},16.666666666666668)}).bind(window);function fe(e){this._nextStep=null,this._lanes=[],this._stepQueue=[],this._stepCallbacks={},this._step=this._step.bind(this);for(var t=0;t<e;t++)this._lanes.push(new Ce)}function Ce(){this.queue=[],this.indices={},this.callbacks={}}fe.prototype._step=function(e){var t,n,s,o,c,l,i=this._lanes,a=this._stepQueue,r=this._stepCallbacks;for(this._nextStep=null,t=0;t<i.length;t++){for(o=i[t].queue,c=i[t].callbacks,l=i[t].indices,s=0;s<o.length;s++)(n=o[s])&&(a.push(n),r[n]=c[n],delete c[n],delete l[n]);o.length=0}for(t=0;t<a.length;t++)r[n=a[t]]&&r[n](e),delete r[n];a.length=0},fe.prototype.add=function(e,t,n){this._lanes[e].add(t,n),this._nextStep||(this._nextStep=Ft(this._step))},fe.prototype.remove=function(e,t){this._lanes[e].remove(t)},Ce.prototype.add=function(e,t){var n=this.indices[e];void 0!==n&&(this.queue[n]=void 0),this.queue.push(e),this.callbacks[e]=t,this.indices[e]=this.queue.length-1},Ce.prototype.remove=function(e){var t=this.indices[e];void 0!==t&&(this.queue[t]=void 0,delete this.callbacks[e],delete this.indices[e])};var Et="layoutRead",xt="layoutWrite",jt="visibilityRead",bt="visibilityWrite",gt="dragStartRead",pt="dragStartWrite",ft="dragMoveRead",mt="dragMoveWrite",He="dragScrollRead",ut="dragScrollWrite",at="dragSortRead",nt="placeholderLayoutRead",et="placeholderLayoutWrite",We="placeholderResizeWrite",Be="autoScrollRead",wt="autoScrollWrite",Ye="debounceRead",i=new fe(3);function Qe(e){i.remove(0,Et+e),i.remove(2,xt+e)}function Ze(e){i.remove(0,jt+e),i.remove(2,bt+e)}function Je(e){i.remove(0,gt+e),i.remove(2,pt+e)}function st(e){i.remove(0,ft+e),i.remove(2,mt+e)}function Ie(e){i.remove(0,He+e),i.remove(2,ut+e)}function ce(e,t){i.add(1,at+e,t)}function Ct(e){i.remove(0,nt+e),i.remove(2,et+e)}function St(e,t){i.add(0,Be,e),i.add(2,wt,t)}function s(e){return"function"==typeof e}X="function"==typeof WeakMap?new WeakMap:null;function l(e,t){var n=X&&X.get(e);return n||(n=window.getComputedStyle(e,null),X&&X.set(e,n)),n.getPropertyValue(t)}function u(e,t){return parseFloat(l(e,t))||0}var m,z=document.documentElement,qt=document.body,be={value:0,offset:0};function ht(e){return e===window||e===z||e===qt?window:e}function K(e){return e===window?e.pageXOffset:e.scrollLeft}function J(e){return e===window?e.pageYOffset:e.scrollTop}function Nt(e){return e===window?z.scrollWidth-z.clientWidth:e.scrollWidth-e.clientWidth}function Lt(e){return e===window?z.scrollHeight-z.clientHeight:e.scrollHeight-e.clientHeight}function Vt(e,t){if(t=t||{},e===window)t.width=z.clientWidth,t.height=z.clientHeight,t.left=0,t.right=t.width,t.top=0,t.bottom=t.height;else{var n=e.getBoundingClientRect(),s=e.clientLeft||u(e,"border-left-width"),o=e.clientTop||u(e,"border-top-width");t.width=e.clientWidth,t.height=e.clientHeight,t.left=n.left+s,t.right=t.left+t.width,t.top=n.top+o,t.bottom=t.top+t.height}return t}function V(e){return e._drag._getGrid()._settings.dragAutoScroll}function Gt(e){if(e._drag&&e._isActive){var t=e._drag;t._scrollDiffX=t._scrollDiffY=0,e._setTranslate(t._left,t._top)}}function ke(e,t,n,s){return be.value=Math.min(s/2,e),be.offset=Math.max(0,n+2*be.value+s*t-s)/2,be}function O(){this.reset()}function B(){this.element=null,this.requestX=null,this.requestY=null,this.scrollLeft=0,this.scrollTop=0}function Y(e,t){this.pool=[],this.createItem=e,this.releaseItem=t}function ie(e,t){var n=function(e,t){return function(e,t){return!(e.left+e.width<=t.left||t.left+t.width<=e.left||e.top+e.height<=t.top||t.top+t.height<=e.top)}(e,t)?(Math.min(e.left+e.width,t.left+t.width)-Math.max(e.left,t.left))*(Math.min(e.top+e.height,t.top+t.height)-Math.max(e.top,t.top)):0}(e,t);return n?n/(Math.min(e.width,t.width)*Math.min(e.height,t.height))*100:0}O.prototype.reset=function(){this.isActive&&this.onStop(),this.item=null,this.element=null,this.isActive=!1,this.isEnding=!1,this.direction=null,this.value=null,this.maxValue=0,this.threshold=0,this.distance=0,this.speed=0,this.duration=0,this.action=null},O.prototype.hasReachedEnd=function(){return 4&this.direction?this.value>=this.maxValue:this.value<=0},O.prototype.computeCurrentScrollValue=function(){return null===this.value?1&this.direction?K(this.element):J(this.element):Math.max(0,Math.min(this.value,this.maxValue))},O.prototype.computeNextScrollValue=function(e){var t=this.speed*(e/1e3),n=4&this.direction?this.value+t:this.value-t;return Math.max(0,Math.min(n,this.maxValue))},O.prototype.computeSpeed=(m={direction:null,threshold:0,distance:0,value:0,maxValue:0,deltaTime:0,duration:0,isEnding:!1},function(e){var n=this.item,t=V(n).speed;return s(t)?(m.direction=this.direction,m.threshold=this.threshold,m.distance=this.distance,m.value=this.value,m.maxValue=this.maxValue,m.duration=this.duration,m.speed=this.speed,m.deltaTime=e,m.isEnding=this.isEnding,t(n,this.element,m)):t}),O.prototype.tick=function(e){return this.isActive||(this.isActive=!0,this.onStart()),this.value=this.computeCurrentScrollValue(),this.speed=this.computeSpeed(e),this.value=this.computeNextScrollValue(e),this.duration+=e,this.value},O.prototype.onStart=function(){var e=this.item,t=V(e).onStart;s(t)&&t(e,this.element,this.direction)},O.prototype.onStop=function(){var e=this.item,t=V(e).onStop;s(t)&&t(e,this.element,this.direction),e._drag&&e._drag.sort()},B.prototype.reset=function(){this.requestX&&(this.requestX.action=null),this.requestY&&(this.requestY.action=null),this.element=null,this.requestX=null,this.requestY=null,this.scrollLeft=0,this.scrollTop=0},B.prototype.addRequest=function(e){1&e.direction?(this.removeRequest(this.requestX),this.requestX=e):(this.removeRequest(this.requestY),this.requestY=e),e.action=this},B.prototype.removeRequest=function(e){e&&(this.requestX===e?(this.requestX=null,e.action=null):this.requestY===e&&(this.requestY=null,e.action=null))},B.prototype.computeScrollValues=function(){this.scrollLeft=this.requestX?this.requestX.value:K(this.element),this.scrollTop=this.requestY?this.requestY.value:J(this.element)},B.prototype.scroll=function(){var e=this.element;e&&(e.scrollTo?e.scrollTo(this.scrollLeft,this.scrollTop):(e.scrollLeft=this.scrollLeft,e.scrollTop=this.scrollTop))},Y.prototype.pick=function(){return this.pool.pop()||this.createItem()},Y.prototype.release=function(e){this.releaseItem(e),-1===this.pool.indexOf(e)&&this.pool.push(e)},Y.prototype.reset=function(){this.pool.length=0},Te={width:0,height:0,left:0,right:0,top:0,bottom:0},ze={width:0,height:0,left:0,right:0,top:0,bottom:0};function o(){this._isDestroyed=!1,this._isTicking=!1,this._tickTime=0,this._tickDeltaTime=0,this._items=[],this._actions=[],this._requests={},this._requests[1]={},this._requests[2]={},this._requestOverlapCheck={},this._dragPositions={},this._dragDirections={},this._overlapCheckInterval=150,this._requestPool=new Y(function(){return new O},function(e){e.reset()}),this._actionPool=new Y(function(){return new B},function(e){e.reset()}),this._readTick=this._readTick.bind(this),this._writeTick=this._writeTick.bind(this)}o.AXIS_X=1,o.AXIS_Y=2,o.FORWARD=4,o.BACKWARD=8,o.LEFT=9,o.RIGHT=5,o.UP=10,o.DOWN=6,o.smoothSpeed=function(e,t,n){return function(s,o,i){a=0,i.isEnding||(i.threshold>0?(l=i.threshold-Math.max(0,i.distance),a=e/i.threshold*l):a=e);var a,l,c=i.speed,r=a;return c===a?r:c<a?(r=c+t*(i.deltaTime/1e3),Math.min(a,r)):(r=c-n*(i.deltaTime/1e3),Math.max(a,r))}},o.pointerHandle=function(e){var t={left:0,top:0,width:0,height:0},n=e||1;return function(e,s,o,i,a,r,c){return t.left=r-.5*n,t.top=c-.5*n,t.width=n,t.height=n,t}},o.prototype._readTick=function(e){this._isDestroyed||(e&&this._tickTime?(this._tickDeltaTime=e-this._tickTime,this._tickTime=e,this._updateRequests(),this._updateActions()):(this._tickTime=e,this._tickDeltaTime=0))},o.prototype._writeTick=function(){this._isDestroyed||(this._applyActions(),St(this._readTick,this._writeTick))},o.prototype._startTicking=function(){this._isTicking=!0,St(this._readTick,this._writeTick)},o.prototype._stopTicking=function(){this._isTicking=!1,this._tickTime=0,this._tickDeltaTime=0,i.remove(0,Be),i.remove(2,wt)},o.prototype._getItemHandleRect=function(e,t,n){if(s=e._drag,t){var s,i=s._dragMoveEvent||s._dragStartEvent,o=t(e,s._clientX,s._clientY,e._width,e._height,i.clientX,i.clientY);n.left=o.left,n.top=o.top,n.width=o.width,n.height=o.height}else n.left=s._clientX,n.top=s._clientY,n.width=e._width,n.height=e._height;return n.right=n.left+n.width,n.bottom=n.top+n.height,n},o.prototype._requestItemScroll=function(e,t,n,s,o,i,a){var c=this._requests[t],r=c[e._id];r?r.element===n&&r.direction===s||r.reset():r=this._requestPool.pick(),r.item=e,r.element=n,r.direction=s,r.threshold=o,r.distance=i,r.maxValue=a,c[e._id]=r},o.prototype._cancelItemScroll=function(e,t){var s=this._requests[t],n=s[e._id];n&&(n.action&&n.action.removeRequest(n),this._requestPool.release(n),delete s[e._id])},o.prototype._checkItemOverlap=function(e,t,n){var u=V(e),y=s(u.targets)?u.targets(e):u.targets,M=u.threshold,P=u.safeZone;if(!y||!y.length)return t&&this._cancelItemScroll(e,1),void(n&&this._cancelItemScroll(e,2));var T=this._dragDirections[e._id],w=T[0],j=T[1];if(!w&&!j)return t&&this._cancelItemScroll(e,1),void(n&&this._cancelItemScroll(e,2));for(var d=this._getItemHandleRect(e,u.handle,Te),l=ze,i=null,r=null,v=!0,g=!0,p=0,c=0,o=null,a=null,h=0,f=0,m=0,O=null,b=-1/0,F=0,k=0,A=null,S=0,E=0,x=null,_=-1/0,z=0,D=0,N=null,L=0,R=0,C=0;C<y.length;C++)i=y[C],v=t&&w&&2!==i.axis,g=n&&j&&1!==i.axis,c=i.priority||0,(!v||c<b)&&(!g||c<_)||(r=ht(i.element||i),f=v?Nt(r):-1,m=g?Lt(r):-1,(f||m)&&((p=ie(d,l=Vt(r,l)))<=0||(v&&c>=b&&f>0&&(c>b||p>k)&&(a=null,o=ke("number"==typeof i.threshold?i.threshold:M,P,d.width,l.width),5===w?(h=l.right+o.offset-d.right)<=o.value&&K(r)<f&&(a=5):9===w&&(h=d.left-(l.left-o.offset))<=o.value&&K(r)>0&&(a=9),null!==a&&(O=r,b=c,F=o.value,k=p,A=a,S=h,E=f)),g&&c>=_&&m>0&&(c>_||p>D)&&(a=null,o=ke("number"==typeof i.threshold?i.threshold:M,P,d.height,l.height),6===j?(h=l.bottom+o.offset-d.bottom)<=o.value&&J(r)<m&&(a=6):10===j&&(h=d.top-(l.top-o.offset))<=o.value&&J(r)>0&&(a=10),null!==a&&(x=r,_=c,z=o.value,D=p,N=a,L=h,R=m)))));t&&(O?this._requestItemScroll(e,1,O,A,F,S,E):this._cancelItemScroll(e,1)),n&&(x?this._requestItemScroll(e,2,x,N,z,L,R):this._cancelItemScroll(e,2))},o.prototype._updateScrollRequest=function(e){for(var f=e.item,o=V(f),m=s(o.targets)?o.targets(f):o.targets,b=m&&m.length||0,v=o.threshold,g=o.safeZone,n=this._getItemHandleRect(f,o.handle,Te),t=ze,r=null,a=null,c=!1,i=null,p=null,h=null,d=null,l=null,u=0;u<b;u++)if((a=ht((r=m[u]).element||r))===e.element){if(c=!!(1&e.direction)){if(2===r.axis)continue}else if(1===r.axis)continue;if((d=c?Nt(a):Lt(a))<=0)break;if(ie(n,t=Vt(a,t))<=0)break;if(i=ke("number"==typeof r.threshold?r.threshold:v,g,c?n.width:n.height,c?t.width:t.height),(p=9===e.direction?n.left-(t.left-i.offset):5===e.direction?t.right+i.offset-n.right:10===e.direction?n.top-(t.top-i.offset):t.bottom+i.offset-n.bottom)>i.value)break;if(h=c?K(a):J(a),l=4&e.direction?h>=d:h<=0)break;return e.maxValue=d,e.threshold=i.value,e.distance=p,e.isEnding=!1,!0}return!0===o.smoothStop&&e.speed>0?(null===l&&(l=e.hasReachedEnd()),e.isEnding=!l):e.isEnding=!1,e.isEnding},o.prototype._updateRequests=function(){for(var e,t,n,s,o,i,r,c=this._items,l=this._requests[1],d=this._requests[2],a=0;a<c.length;a++)e=c[a],t=(r=this._requestOverlapCheck[e._id])>0&&this._tickTime-r>this._overlapCheckInterval,o=!0,(n=l[e._id])&&n.isActive&&(o=!this._updateScrollRequest(n))&&(t=!0,this._cancelItemScroll(e,1)),i=!0,(s=d[e._id])&&s.isActive&&(i=!this._updateScrollRequest(s))&&(t=!0,this._cancelItemScroll(e,2)),t&&(this._requestOverlapCheck[e._id]=0,this._checkItemOverlap(e,o,i))},o.prototype._requestAction=function(e,t){for(var s=this._actions,i=1===t,n=null,o=0;o<s.length;o++){if(n=s[o],e.element===n.element){if(i?n.requestX:n.requestY)return void this._cancelItemScroll(e.item,t);break}n=null}n||(n=this._actionPool.pick()),n.element=e.element,n.addRequest(e),e.tick(this._tickDeltaTime),s.push(n)},o.prototype._updateActions=function(){var e,t,n,s,o=this._items,i=this._requests,a=this._actions;for(e=0;e<o.length;e++)t=o[e]._id,n=i[1][t],s=i[2][t],n&&this._requestAction(n,1),s&&this._requestAction(s,2);for(e=0;e<a.length;e++)a[e].computeScrollValues()},o.prototype._applyActions=function(){var e,s,t=this._actions,n=this._items;if(t.length){for(e=0;e<t.length;e++)t[e].scroll(),this._actionPool.release(t[e]);for(t.length=0,e=0;e<n.length;e++)(s=n[e])._drag&&s._drag._prepareScroll();for(e=0;e<n.length;e++)Gt(n[e])}},o.prototype._updateDragDirection=function(e){var i,a,t=this._dragPositions[e._id],n=this._dragDirections[e._id],s=e._drag._left,o=e._drag._top;t.length&&(i=t[0],a=t[1],n[0]=s>i?5:s<i?9:n[0]||0,n[1]=o>a?6:o<a?10:n[1]||0),t[0]=s,t[1]=o},o.prototype.addItem=function(e){this._isDestroyed||-1===this._items.indexOf(e)&&(this._items.push(e),this._requestOverlapCheck[e._id]=this._tickTime,this._dragDirections[e._id]=[0,0],this._dragPositions[e._id]=[],this._isTicking||this._startTicking())},o.prototype.updateItem=function(e){this._isDestroyed||this._dragDirections[e._id]&&(this._updateDragDirection(e),this._requestOverlapCheck[e._id]||(this._requestOverlapCheck[e._id]=this._tickTime))},o.prototype.removeItem=function(e){if(!this._isDestroyed){var t,n=this._items.indexOf(e);-1!==n&&(t=e._id,this._requests[1][t]&&(this._cancelItemScroll(e,1),delete this._requests[1][t]),this._requests[2][t]&&(this._cancelItemScroll(e,2),delete this._requests[2][t]),delete this._requestOverlapCheck[t],delete this._dragPositions[t],delete this._dragDirections[t],this._items.splice(n,1),this._isTicking&&!this._items.length&&this._stopTicking())}},o.prototype.isItemScrollingX=function(e){var t=this._requests[1][e._id];return!!t&&!!t.isActive},o.prototype.isItemScrollingY=function(e){var t=this._requests[2][e._id];return!!t&&!!t.isActive},o.prototype.isItemScrolling=function(e){return this.isItemScrollingX(e)||this.isItemScrollingY(e)},o.prototype.destroy=function(){if(!this._isDestroyed){for(var t=this._items.slice(0),e=0;e<t.length;e++)this.removeItem(t[e]);this._actions.length=0,this._requestPool.reset(),this._actionPool.reset(),this._isDestroyed=!0}},T=window.Element.prototype,Ge=T.matches||T.matchesSelector||T.webkitMatchesSelector||T.mozMatchesSelector||T.msMatchesSelector||T.oMatchesSelector||function(){return!1};function te(e,t){return Ge.call(e,t)}function d(e,t){t&&(e.classList?e.classList.add(t):te(e,"."+t)||(e.className+=" "+t))}ye=[];function Pe(e,t,n){var s="number"==typeof n?n:-1;s<0&&(s=e.length-s+1),e.splice.apply(e,ye.concat(s,0,t)),ye.length=0}function L(e,t,n){var s=Math.max(0,e.length-1+(n||0));return t>s?s:t<0?Math.max(s+t+1,0):t}function Ve(e,t,n){if(!(e.length<2)){var s=L(e,t),o=L(e,n);s!==o&&e.splice(o,0,e.splice(s,1)[0])}}function $e(e,t,n){if(!(e.length<2)){var i,s=L(e,t),o=L(e,n);s!==o&&(i=e[s],e[s]=e[o],e[o]=i)}}var v=pe(document.documentElement.style,"transform")||"transform",Qt=/([A-Z])/g,an=/^(webkit-|moz-|ms-|o-)/,on=/^(-m-s-)/;function Re(e){var t=e.replace(Qt,"-$1").toLowerCase();return t=(t=t.replace(an,"-$1")).replace(on,"-ms-")}Le=Re(v);function sn(e){var t,n=l(e,Le);return!!n&&"none"!==n&&(t=l(e,"display"),"inline"!==t&&"none"!==t)}function Ne(e){for(var n=document,t=e||n;t&&t!==n&&"static"===l(t,"position")&&!sn(t);)t=t.parentElement||n;return t}var De={},Fe={},Q={};function tt(e,t){var s,n=t||{};return n.left=0,n.top=0,e===document?n:(n.left=window.pageXOffset||0,n.top=window.pageYOffset||0,e.self===window.self||(s=e.getBoundingClientRect(),n.left+=s.left,n.top+=s.top,n.left+=u(e,"border-left-width"),n.top+=u(e,"border-top-width")),n)}function P(e,t,n){return Q.left=0,Q.top=0,e===t||n&&(e=Ne(e))===(t=Ne(t))||(tt(e,De),tt(t,Fe),Q.left=Fe.left-De.left,Q.top=Fe.top-De.top),Q}function Me(e){return"auto"===e||"scroll"===e||"overlay"===e}function nn(e){return Me(l(e,"overflow"))||Me(l(e,"overflow-x"))||Me(l(e,"overflow-y"))}function it(e,t){for(t=t||[];e&&e!==document;)e.getRootNode&&e instanceof DocumentFragment?e=e.getRootNode().host:(nn(e)&&t.push(e),e=e.parentNode);return t.push(window),t}var H={},tn=/^matrix3d/,en=/([^,]*,){4}/,Kt=/([^,]*,){12}/,Ut=/[^,]*,/;function y(e){if(H.x=0,H.y=0,t=l(e,Le),!t||"none"===t)return H;var t,s=tn.test(t),n=t.replace(s?Kt:en,""),o=n.replace(Ut,"");return H.x=parseFloat(n)||0,H.y=parseFloat(o)||0,H}function r(e,t){t&&(e.classList?e.classList.remove(t):te(e,"."+t)&&(e.className=(" "+e.className+" ").replace(" "+t+" "," ").trim()))}vt=/^(iPad|iPhone|iPod)/.test(window.navigator.platform)||/^Mac/.test(window.navigator.platform)&&window.navigator.maxTouchPoints>1,je=!!Ht()&&{passive:!0};function t(n){var i=n._element,a=n.getGrid(),o=a._settings;this._item=n,this._gridId=a._id,this._isDestroyed=!1,this._isMigrating=!1,this._startPredicate=s(o.dragStartPredicate)?o.dragStartPredicate:t.defaultStartPredicate,this._startPredicateState=0,this._startPredicateResult=void 0,this._isSortNeeded=!1,this._sortTimer=void 0,this._blockedSortIndex=null,this._sortX1=0,this._sortX2=0,this._sortY1=0,this._sortY2=0,this._reset(),this._preStartCheck=this._preStartCheck.bind(this),this._preEndCheck=this._preEndCheck.bind(this),this._onScroll=this._onScroll.bind(this),this._prepareStart=this._prepareStart.bind(this),this._applyStart=this._applyStart.bind(this),this._prepareMove=this._prepareMove.bind(this),this._applyMove=this._applyMove.bind(this),this._prepareScroll=this._prepareScroll.bind(this),this._applyScroll=this._applyScroll.bind(this),this._handleSort=this._handleSort.bind(this),this._handleSortDelayed=this._handleSortDelayed.bind(this),this._handle=o.dragHandle&&i.querySelector(o.dragHandle)||i,this._dragger=new e(this._handle,o.dragCssProps),this._dragger.on("start",this._preStartCheck),this._dragger.on("move",this._preStartCheck),this._dragger.on("cancel",this._preEndCheck),this._dragger.on("end",this._preEndCheck)}function yt(e,t){var n,s,o={};if(Array.isArray(t))for(s=0;s<t.length;s++)o[n=t[s]]=l(e,Re(n));else for(n in t)o[n]=l(e,Re(n));return o}t.autoScroller=new o,t.defaultStartPredicate=function(e,t,n){var s,i,o=e._drag;if(t.isFirst&&t.srcEvent.button)return!1;if(!vt&&t.isFirst&&!0===t.srcEvent.isTrusted&&!1===t.srcEvent.defaultPrevented&&!1===t.srcEvent.cancelable)return!1;if(!t.isFinal)return s=o._startPredicateData,s||(i=n||o._getGrid()._settings.dragStartPredicate||{},o._startPredicateData=s={distance:Math.max(i.distance,0)||0,delay:Math.max(i.delay,0)||0}),s.delay&&(s.event=t,s.delayTimer||(s.delayTimer=window.setTimeout(function(){s.delay=0,o._resolveStartPredicate(s.event)&&(o._forceResolveStartPredicate(s.event),o._resetStartPredicate())},s.delay))),o._resolveStartPredicate(t);o._finishStartPredicate(t)},t.defaultSortPredicate=(_={},p={},W={},le=[],function(e,t){var c=e._drag,g=c._getGrid(),i=t&&"number"==typeof t.threshold?t.threshold:50,y=t&&t.action===b?b:N,j=t&&t.migrateAction===b?b:N,i=Math.min(Math.max(i,1),100);if(_.width=e._width,_.height=e._height,_.left=c._clientX,_.top=c._clientY,n=function(e,t,n){var o,i,a,r,c,d,u,h,m,f,g=null,v=t._settings.dragSort,b=-1;if(!0===v?(le[0]=t,a=le):s(v)&&(a=v.call(t,e)),!a||!Array.isArray(a)||!a.length)return g;for(m=0;m<a.length;m++)if(!(i=a[m])._isDestroyed){for(i._updateBoundingRect(),c=Math.max(0,i._left),r=Math.max(0,i._top),u=Math.min(window.innerWidth,i._right),h=Math.min(window.innerHeight,i._bottom),o=i._element.parentNode;o&&o!==document&&o!==document.documentElement&&o!==document.body;)if(o.getRootNode&&o instanceof DocumentFragment)o=o.getRootNode().host;else{if("visible"!==l(o,"overflow")&&(d=o.getBoundingClientRect(),c=Math.max(c,d.left),r=Math.max(r,d.top),u=Math.min(u,d.right),h=Math.min(h,d.bottom)),"fixed"===l(o,"position"))break;o=o.parentNode}c>=u||r>=h||(p.left=c,p.top=r,p.width=u-c,p.height=h-r,(f=ie(_,p))>n&&f>b&&(b=f,g=i))}return le.length=0,g}(e,g,i),!n)return null;var n,o,a,h,u=e.getGrid()!==n,m=0,f=0,r=0,d=-1,v=!1;for(n===g?(_.left=c._gridX+e._marginLeft,_.top=c._gridY+e._marginTop):(n._updateBorders(1,0,1,0),m=n._left+n._borderLeft,f=n._top+n._borderTop),a=0;a<n._items.length;a++)(o=n._items[a])._isActive&&o!==e&&(v=!0,p.width=o._width,p.height=o._height,p.left=o._left+o._marginLeft+m,p.top=o._top+o._marginTop+f,(h=ie(_,p))>r&&(d=a,r=h));return u&&r<i&&(d=v?d:0,r=i),r>=i?(W.grid=n,W.index=d,W.action=u?j:y,W):null}),t.prototype.stop=function(){if(this._isActive)if(this._isMigrating)this._finishMigration();else{if(e=this._item,n=e._id,t.autoScroller.removeItem(e),Je(n),st(n),Ie(n),this._cancelSort(),this._isStarted){this._unbindScrollListeners();var e,n,s=e._element,o=this._getGrid(),i=o._settings.itemDraggingClass;s.parentNode!==o._element&&(o._element.appendChild(s),e._setTranslate(this._gridX,this._gridY),i&&s.clientWidth),r(s,i)}this._reset()}},t.prototype.sort=function(e){var t=this._item;this._isActive&&t._isActive&&this._dragMoveEvent&&(!0===e?this._handleSort():ce(t._id,this._handleSort))},t.prototype.destroy=function(){this._isDestroyed||(this.stop(),this._dragger.destroy(),t.autoScroller.removeItem(this._item),this._isDestroyed=!0)},t.prototype._getGrid=function(){return de[this._gridId]||null},t.prototype._reset=function(){this._isActive=!1,this._isStarted=!1,this._container=null,this._containingBlock=null,this._dragStartEvent=null,this._dragMoveEvent=null,this._dragPrevMoveEvent=null,this._scrollEvent=null,this._scrollers=[],this._left=0,this._top=0,this._gridX=0,this._gridY=0,this._clientX=0,this._clientY=0,this._scrollDiffX=0,this._scrollDiffY=0,this._moveDiffX=0,this._moveDiffY=0,this._containerDiffX=0,this._containerDiffY=0},t.prototype._bindScrollListeners=function(){var e,n,s=this._getGrid()._element,o=this._container,t=this._scrollers;if(t.length=0,it(this._item._element.parentNode,t),o!==s)for(it(s,n=[]),e=0;e<n.length;e++)t.indexOf(n[e])<0&&t.push(n[e]);for(e=0;e<t.length;e++)t[e].addEventListener("scroll",this._onScroll,je)},t.prototype._unbindScrollListeners=function(){var e,t=this._scrollers;for(e=0;e<t.length;e++)t[e].removeEventListener("scroll",this._onScroll,je);t.length=0},t.prototype._resolveStartPredicate=function(e){var t=this._startPredicateData;if(!(e.distance<t.distance||t.delay))return this._resetStartPredicate(),!0},t.prototype._forceResolveStartPredicate=function(e){this._isDestroyed||1!==this._startPredicateState||(this._startPredicateState=2,this._onStart(e))},t.prototype._finishStartPredicate=function(e){var t=this._item._element,n=Math.abs(e.deltaX)<2&&Math.abs(e.deltaY)<2&&e.deltaTime<200;this._resetStartPredicate(),n&&function(e){if("a"!==e.tagName.toLowerCase())return;var t,n=e.getAttribute("href");if(!n)return;t=e.getAttribute("target"),t&&"_self"!==t?window.open(n,t):window.location.href=n}(t)},t.prototype._resetHeuristics=function(e,t){this._blockedSortIndex=null,this._sortX1=this._sortX2=e,this._sortY1=this._sortY2=t},t.prototype._checkHeuristics=function(e,t){if(s=this._getGrid()._settings.dragSortHeuristics,n=s.minDragDistance,n<=0)return this._blockedSortIndex=null,!0;var n,s,o=e-this._sortX2,i=t-this._sortY2,a=n>3&&s.minBounceBackAngle>0;if(a||(this._blockedSortIndex=null),Math.abs(o)>n||Math.abs(i)>n){if(a){var r=Math.atan2(o,i),c=Math.atan2(this._sortX2-this._sortX1,this._sortY2-this._sortY1),l=Math.atan2(Math.sin(r-c),Math.cos(r-c));Math.abs(l)>s.minBounceBackAngle&&(this._blockedSortIndex=null)}return this._sortX1=this._sortX2,this._sortY1=this._sortY2,this._sortX2=e,this._sortY2=t,!0}return!1},t.prototype._resetStartPredicate=function(){var e=this._startPredicateData;e&&(e.delayTimer&&(e.delayTimer=window.clearTimeout(e.delayTimer)),this._startPredicateData=null)},t.prototype._handleSort=function(){if(this._isActive){var n,s,e=this._getGrid()._settings;if(!e.dragSort||!e.dragAutoScroll.sortDuringScroll&&t.autoScroller.isItemScrolling(this._item))return this._sortX1=this._sortX2=this._gridX,this._sortY1=this._sortY2=this._gridY,this._isSortNeeded=!0,void(void 0!==this._sortTimer&&(this._sortTimer=window.clearTimeout(this._sortTimer)));s=this._checkHeuristics(this._gridX,this._gridY),(this._isSortNeeded||s)&&(n=e.dragSortHeuristics.sortInterval,n<=0||this._isSortNeeded?(this._isSortNeeded=!1,void 0!==this._sortTimer&&(this._sortTimer=window.clearTimeout(this._sortTimer)),this._checkOverlap()):void 0===this._sortTimer&&(this._sortTimer=window.setTimeout(this._handleSortDelayed,n)))}},t.prototype._handleSortDelayed=function(){this._isSortNeeded=!0,this._sortTimer=void 0,ce(this._item._id,this._handleSort)},t.prototype._cancelSort=function(){var e;this._isSortNeeded=!1,void 0!==this._sortTimer&&(this._sortTimer=window.clearTimeout(this._sortTimer)),e=this._item._id,i.remove(1,at+e)},t.prototype._finishSort=function(){var e=this._getGrid()._settings.dragSort&&(this._isSortNeeded||void 0!==this._sortTimer);this._cancelSort(),e&&this._checkOverlap()},t.prototype._checkOverlap=function(){if(this._isActive){var e,n,i,a,r,c,l,d,o=this._item,u=this._getGrid()._settings;(r=s(u.dragSortPredicate)?u.dragSortPredicate(o,this._dragMoveEvent):t.defaultSortPredicate(o,u.dragSortPredicate))&&"number"==typeof r.index&&(l=r.action===b?b:N,d=(e=o.getGrid())!==(n=r.grid||e),i=e._items.indexOf(o),a=L(n._items,r.index,d&&l===N?1:0),(d||a!==this._blockedSortIndex)&&(d?(this._blockedSortIndex=null,c=n._items[a],e._hasListeners(E)&&e._emit(E,{item:o,fromGrid:e,fromIndex:i,toGrid:n,toIndex:a}),n._hasListeners(ae)&&n._emit(ae,{item:o,fromGrid:e,fromIndex:i,toGrid:n,toIndex:a}),o._gridId=n._id,this._isMigrating=o._gridId!==this._gridId,e._items.splice(i,1),Pe(n._items,o,a),o._sortData=null,e._hasListeners(se)&&e._emit(se,{item:o,fromGrid:e,fromIndex:i,toGrid:n,toIndex:a}),n._hasListeners(ee)&&n._emit(ee,{item:o,fromGrid:e,fromIndex:i,toGrid:n,toIndex:a}),l===b&&c&&c.isActive()&&n._items.indexOf(c)>-1&&n.send(c,e,i,{appendTo:this._container||document.body,layoutSender:!1,layoutReceiver:!1}),e.layout(),n.layout()):i!==a&&(this._blockedSortIndex=i,(l===b?$e:Ve)(e._items,i,a),e._hasListeners(ne)&&e._emit(ne,{item:o,fromIndex:i,toIndex:a,action:l}),e.layout())))}},t.prototype._finishMigration=function(){var o,a,e=this._item,l=e._dragRelease,s=e._element,u=e._isActive,f=e.getGrid(),m=f._element,n=f._settings,i=n.dragContainer||m,c=this._getGrid()._settings,h=s.parentNode,p=u?c.itemVisibleClass:c.itemHiddenClass,g=u?n.itemVisibleClass:n.itemHiddenClass;this._isMigrating=!1,this.destroy(),c.itemClass!==n.itemClass&&(r(s,c.itemClass),d(s,n.itemClass)),p!==g&&(r(s,p),d(s,g)),i!==h&&(i.appendChild(s),o=P(h,i,!0),(a=y(s)).x-=o.left,a.y-=o.top),e._refreshDimensions(),o=P(i,m,!0),l._containerDiffX=o.left,l._containerDiffY=o.top,e._drag=n.dragEnabled?new t(e):null,i!==h&&e._setTranslate(a.x,a.y),e._visibility.setStyles(u?n.visibleStyles:n.hiddenStyles),l.start()},t.prototype._preStartCheck=function(e){0===this._startPredicateState&&(this._startPredicateState=1),1===this._startPredicateState?(this._startPredicateResult=this._startPredicate(this._item,e),!0===this._startPredicateResult?(this._startPredicateState=2,this._onStart(e)):!1===this._startPredicateResult&&(this._resetStartPredicate(e),this._dragger._reset(),this._startPredicateState=0)):2===this._startPredicateState&&this._isActive&&this._onMove(e)},t.prototype._preEndCheck=function(e){var t=2===this._startPredicateState;this._startPredicate(this._item,e),this._startPredicateState=0,t&&this._isActive&&(this._isStarted?this._onEnd(e):this.stop())},t.prototype._onStart=function(e){var n,o,a,s=this._item;s._isActive&&(this._isActive=!0,this._dragStartEvent=e,t.autoScroller.addItem(s),n=s._id,o=this._prepareStart,a=this._applyStart,i.add(0,gt+n,o),i.add(2,pt+n,a))},t.prototype._prepareStart=function(){if(this._isActive&&(e=this._item,e._isActive)){var e,s,o=e._element,i=this._getGrid(),l=i._settings,t=i._element,n=l.dragContainer||t,a=Ne(n),r=y(o),c=o.getBoundingClientRect(),d=n!==t;this._container=n,this._containingBlock=a,this._clientX=c.left,this._clientY=c.top,this._left=this._gridX=r.x,this._top=this._gridY=r.y,this._scrollDiffX=this._scrollDiffY=0,this._moveDiffX=this._moveDiffY=0,this._resetHeuristics(this._gridX,this._gridY),d&&(s=P(a,t),this._containerDiffX=s.left,this._containerDiffY=s.top)}},t.prototype._applyStart=function(){if(this._isActive&&(e=this._item,e._isActive)){var e,n=this._getGrid(),s=e._element,o=e._dragRelease,t=e._migrate,i=this._container!==n._element;e.isPositioning()&&e._layout.stop(!0,this._left,this._top),t._isActive&&(this._left-=t._containerDiffX,this._top-=t._containerDiffY,this._gridX-=t._containerDiffX,this._gridY-=t._containerDiffY,t.stop(!0,this._left,this._top)),e.isReleasing()&&o._reset(),n._settings.dragPlaceholder.enabled&&e._dragPlaceholder.create(),this._isStarted=!0,n._emit("dragInit",e,this._dragStartEvent),i&&(s.parentNode===this._container?(this._gridX-=this._containerDiffX,this._gridY-=this._containerDiffY):(this._left+=this._containerDiffX,this._top+=this._containerDiffY,this._container.appendChild(s),e._setTranslate(this._left,this._top))),d(s,n._settings.itemDraggingClass),this._bindScrollListeners(),n._emit("dragStart",e,this._dragStartEvent)}},t.prototype._onMove=function(e){var t,s,o,n=this._item;n._isActive?(this._dragMoveEvent=e,t=n._id,s=this._prepareMove,o=this._applyMove,i.add(0,ft+t,s),i.add(2,mt+t,o),ce(n._id,this._handleSort)):this.stop()},t.prototype._prepareMove=function(){if(this._isActive&&this._item._isActive){var e,t,s=this._getGrid()._settings.dragAxis,n=this._dragMoveEvent,o=this._dragPrevMoveEvent||this._dragStartEvent||n;"y"!==s&&(e=n.clientX-o.clientX,this._left=this._left-this._moveDiffX+e,this._gridX=this._gridX-this._moveDiffX+e,this._clientX=this._clientX-this._moveDiffX+e,this._moveDiffX=e),"x"!==s&&(t=n.clientY-o.clientY,this._top=this._top-this._moveDiffY+t,this._gridY=this._gridY-this._moveDiffY+t,this._clientY=this._clientY-this._moveDiffY+t,this._moveDiffY=t),this._dragPrevMoveEvent=n}},t.prototype._applyMove=function(){if(this._isActive){var e=this._item;e._isActive&&(this._moveDiffX=this._moveDiffY=0,e._setTranslate(this._left,this._top),this._getGrid()._emit("dragMove",e,this._dragMoveEvent),t.autoScroller.updateItem(e))}},t.prototype._onScroll=function(e){var t,s,o,n=this._item;n._isActive?(this._scrollEvent=e,t=n._id,s=this._prepareScroll,o=this._applyScroll,i.add(0,He+t,s),i.add(2,ut+t,o),ce(n._id,this._handleSort)):this.stop()},t.prototype._prepareScroll=function(){if(this._isActive&&(e=this._item,e._isActive)){var e,t,n,s,a=e._element,o=this._getGrid()._element,i=a.getBoundingClientRect();this._container!==o&&(t=P(this._containingBlock,o),this._containerDiffX=t.left,this._containerDiffY=t.top),n=this._clientX-this._moveDiffX-i.left,this._left=this._left-this._scrollDiffX+n,this._scrollDiffX=n,s=this._clientY-this._moveDiffY-i.top,this._top=this._top-this._scrollDiffY+s,this._scrollDiffY=s,this._gridX=this._left-this._containerDiffX,this._gridY=this._top-this._containerDiffY}},t.prototype._applyScroll=function(){if(this._isActive){var e=this._item;e._isActive&&(this._scrollDiffX=this._scrollDiffY=0,e._setTranslate(this._left,this._top),this._getGrid()._emit("dragScroll",e,this._scrollEvent))}},t.prototype._onEnd=function(e){var n=this._item,i=n._element,o=this._getGrid(),a=o._settings,s=n._dragRelease;n._isActive?(Je(n._id),st(n._id),Ie(n._id),this._finishSort(),this._unbindScrollListeners(),s._containerDiffX=this._containerDiffX,s._containerDiffY=this._containerDiffY,this._reset(),r(i,a.itemDraggingClass),t.autoScroller.removeItem(n),o._emit("dragEnd",n,e),this._isMigrating?this._finishMigration():s.start()):this.stop()},_t=/^(webkit|moz|ms|o|Webkit|Moz|MS|O)(?=[A-Z])/,Se={};function $t(e){var t=Se[e];return t||((t=e.replace(_t,""))!==e&&(t=t[0].toLowerCase()+t.slice(1)),Se[e]=t,t)}function I(e,t){for(var n in t)e.style[n]=t[n]}kt=!!Element&&!!s(Element.prototype.animate),Ee=!!(Element&&(Ae=Element.prototype.animate,ue=window.Symbol,Ae&&s(ue)&&s(ue.toString)&&ue(Ae).toString().indexOf("[native code]")>-1));function g(e){this._element=e,this._animation=null,this._duration=0,this._easing="",this._callback=null,this._props=[],this._values=[],this._isDestroyed=!1,this._onFinish=this._onFinish.bind(this)}function Mt(e,t){var n,s={};for(n in e)s[t?n:$t(n)]=e[n];return s}function C(e,t){return"translateX("+e+"px) translateY("+t+"px)"}function c(e){this._item=e,this._animation=new g,this._element=null,this._className="",this._didMigrate=!1,this._resetAfterLayout=!1,this._left=0,this._top=0,this._transX=0,this._transY=0,this._nextTransX=0,this._nextTransY=0,this._setupAnimation=this._setupAnimation.bind(this),this._startAnimation=this._startAnimation.bind(this),this._updateDimensions=this._updateDimensions.bind(this),this._onLayoutStart=this._onLayoutStart.bind(this),this._onLayoutEnd=this._onLayoutEnd.bind(this),this._onReleaseEnd=this._onReleaseEnd.bind(this),this._onMigrate=this._onMigrate.bind(this),this._onHide=this._onHide.bind(this)}function A(e){this._item=e,this._isActive=!1,this._isDestroyed=!1,this._isPositioningStarted=!1,this._containerDiffX=0,this._containerDiffY=0}g.prototype.start=function(e,t,n){if(!this._isDestroyed){if(r=this._element,o=n||{},!kt)return I(r,t),this._callback=s(o.onFinish)?o.onFinish:null,void this._onFinish();var o,i,r,l,f,d=this._animation,c=this._props,u=this._values,h=o.duration||300,m=o.easing||"ease",a=!1;if(d&&(l=0,h===this._duration&&m===this._easing||(a=!0),!a)){for(i in t)if(++l,-1===(f=c.indexOf(i))||t[i]!==u[f]){a=!0;break}l!==c.length&&(a=!0)}if(a&&d.cancel(),this._callback=s(o.onFinish)?o.onFinish:null,!d||a){for(i in c.length=u.length=0,t)c.push(i),u.push(t[i]);this._duration=h,this._easing=m,this._animation=r.animate([Mt(e,Ee),Mt(t,Ee)],{duration:h,easing:m}),this._animation.onfinish=this._onFinish,I(r,t)}}},g.prototype.stop=function(){!this._isDestroyed&&this._animation&&(this._animation.cancel(),this._animation=this._callback=null,this._props.length=this._values.length=0)},g.prototype.getCurrentStyles=function(){return yt(element,currentProps)},g.prototype.isAnimating=function(){return!!this._animation},g.prototype.destroy=function(){this._isDestroyed||(this.stop(),this._element=null,this._isDestroyed=!0)},g.prototype._onFinish=function(){var e=this._callback;this._animation=this._callback=null,this._props.length=this._values.length=0,e&&e()},c.prototype._updateDimensions=function(){this.isActive()&&I(this._element,{width:this._item._width+"px",height:this._item._height+"px"})},c.prototype._onLayoutStart=function(e,t){if(n=this._item,-1!==e.indexOf(n)){{var n,s=n._left,o=n._top,h=this._left,m=this._top;if(this._left=s,this._top=o,t||this._didMigrate||h!==s||m!==o){var a,r,c,l=s+n._marginLeft,d=o+n._marginTop,u=n.getGrid();if(!(!t&&u._settings.layoutDuration>0)||this._didMigrate)return Ct(n._id),this._element.style[v]=C(l,d),this._animation.stop(),void(this._didMigrate&&(u.getElement().appendChild(this._element),this._didMigrate=!1));this._nextTransX=l,this._nextTransY=d,a=n._id,r=this._setupAnimation,c=this._startAnimation,i.add(0,nt+a,r),i.add(2,et+a,c)}}}else this.reset()},c.prototype._setupAnimation=function(){if(this.isActive()){var e=y(this._element);this._transX=e.x,this._transY=e.y}},c.prototype._startAnimation=function(){if(this.isActive()){var e=this._animation,s=this._transX,o=this._transY,t=this._nextTransX,n=this._nextTransY;if(s!==t||o!==n){var i=this._item.getGrid()._settings,a={},r={};a[v]=C(s,o),r[v]=C(t,n),e.start(a,r,{duration:i.layoutDuration,easing:i.layoutEasing,onFinish:this._onLayoutEnd})}else e.isAnimating()&&(this._element.style[v]=C(t,n),e.stop())}},c.prototype._onLayoutEnd=function(){this._resetAfterLayout&&this.reset()},c.prototype._onReleaseEnd=function(e){if(e._id===this._item._id){if(!this._animation.isAnimating())return void this.reset();this._resetAfterLayout=!0}},c.prototype._onMigrate=function(e){if(e.item===this._item){var t=this._item.getGrid(),n=e.toGrid;t.off(q,this._onReleaseEnd),t.off(M,this._onLayoutStart),t.off(E,this._onMigrate),t.off($,this._onHide),n.on(q,this._onReleaseEnd),n.on(M,this._onLayoutStart),n.on(E,this._onMigrate),n.on($,this._onHide),this._didMigrate=!0}},c.prototype._onHide=function(e){e.indexOf(this._item)>-1&&this.reset()},c.prototype.create=function(){if(this.isActive())this._resetAfterLayout=!1;else{var t,e=this._item,n=e.getGrid(),o=n._settings,i=this._animation;this._left=e._left,this._top=e._top,t=s(o.dragPlaceholder.createElement)?o.dragPlaceholder.createElement(e):document.createElement("div"),this._element=t,i._element=t,this._className=o.itemPlaceholderClass||"",this._className&&d(t,this._className),I(t,{position:"absolute",left:"0px",top:"0px",width:e._width+"px",height:e._height+"px"}),t.style[v]=C(e._left+e._marginLeft,e._top+e._marginTop),n.on(M,this._onLayoutStart),n.on(q,this._onReleaseEnd),n.on(E,this._onMigrate),n.on($,this._onHide),s(o.dragPlaceholder.onCreate)&&o.dragPlaceholder.onCreate(e,t),n.getElement().appendChild(t)}},c.prototype.reset=function(){if(this.isActive()){var o,t=this._element,n=this._item,e=n.getGrid(),a=e._settings,c=this._animation;this._resetAfterLayout=!1,Ct(n._id),o=n._id,i.remove(2,We+o),c.stop(),c._element=null,e.off(q,this._onReleaseEnd),e.off(M,this._onLayoutStart),e.off(E,this._onMigrate),e.off($,this._onHide),this._className&&(r(t,this._className),this._className=""),t.parentNode.removeChild(t),this._element=null,s(a.dragPlaceholder.onRemove)&&a.dragPlaceholder.onRemove(n,t)}},c.prototype.isActive=function(){return!!this._element},c.prototype.getElement=function(){return this._element},c.prototype.updateDimensions=function(){var e,t;this.isActive()&&(e=this._item._id,t=this._updateDimensions,i.add(2,We+e,t))},c.prototype.destroy=function(){this.reset(),this._animation.destroy(),this._item=this._animation=null},A.prototype.start=function(){if(!this._isDestroyed&&!this._isActive){var e=this._item,t=e.getGrid(),n=t._settings;this._isActive=!0,d(e._element,n.itemReleasingClass),n.dragRelease.useDragContainer||this._placeToGrid(),t._emit("dragReleaseStart",e),t._nextLayoutData||e._layout.start(!1)}},A.prototype.stop=function(e,t,n){if(!this._isDestroyed&&this._isActive){var o,s=this._item,i=s.getGrid();e||void 0!==t&&void 0!==n||(t=s._left,n=s._top),o=this._placeToGrid(t,n),this._reset(o),e||i._emit(q,s)}},A.prototype.isJustReleased=function(){return this._isActive&&!1===this._isPositioningStarted},A.prototype.destroy=function(){this._isDestroyed||(this.stop(!0),this._item=null,this._isDestroyed=!0)},A.prototype._placeToGrid=function(e,t){if(!this._isDestroyed){var o,n=this._item,s=n._element,i=n.getGrid()._element,a=!1;return s.parentNode!==i&&((void 0===e||void 0===t)&&(o=y(s),e=o.x-this._containerDiffX,t=o.y-this._containerDiffY),i.appendChild(s),n._setTranslate(e,t),a=!0),this._containerDiffX=0,this._containerDiffY=0,a}},A.prototype._reset=function(e){if(!this._isDestroyed){var t=this._item,n=t.getGrid()._settings.itemReleasingClass;this._isActive=!1,this._isPositioningStarted=!1,this._containerDiffX=0,this._containerDiffY=0,n&&(e&&t._element.clientWidth,r(t._element,n))}};function w(e){var t=e._element,n=t.style;this._item=e,this._isActive=!1,this._isDestroyed=!1,this._isInterrupted=!1,this._currentStyles={},this._targetStyles={},this._nextLeft=0,this._nextTop=0,this._offsetLeft=0,this._offsetTop=0,this._skipNextAnimation=!1,this._animOptions={onFinish:this._finish.bind(this),duration:0,easing:0},n.left="0px",n.top="0px",e._setTranslate(0,0),this._animation=new g(t),this._queue="layout-"+e._id,this._setupAnimation=this._setupAnimation.bind(this),this._startAnimation=this._startAnimation.bind(this)}function Z(e){this._item=e,this._isActive=!1,this._isDestroyed=!1,this._container=!1,this._containerDiffX=0,this._containerDiffY=0}function f(e){var t=e._isActive,s=e._element,o=s.children[0],n=e.getGrid()._settings;if(!o)throw new Error("No valid child element found within item element.");this._item=e,this._isDestroyed=!1,this._isHidden=!t,this._isHiding=!1,this._isShowing=!1,this._childElement=o,this._currentStyleProps=[],this._animation=new g(o),this._queue="visibility-"+e._id,this._finishShow=this._finishShow.bind(this),this._finishHide=this._finishHide.bind(this),s.style.display=t?"":"none",d(s,t?n.itemVisibleClass:n.itemHiddenClass),this.setStyles(t?n.visibleStyles:n.hiddenStyles)}w.prototype.start=function(e,t){if(!this._isDestroyed){var a,c,l,n=this._item,d=n._dragRelease,o=n.getGrid()._settings,u=this._isActive,r=d.isJustReleased(),h=r?o.dragRelease.duration:o.layoutDuration,m=r?o.dragRelease.easing:o.layoutEasing,f=!e&&!this._skipNextAnimation&&h>0;if(u&&(Qe(n._id),n._emitter.burst(this._queue,!0,n)),r&&(d._isPositioningStarted=!0),s(t)&&n._emitter.on(this._queue,t),this._skipNextAnimation=!1,!f)return this._updateOffsets(),n._setTranslate(this._nextLeft,this._nextTop),this._animation.stop(),void this._finish();this._animation.isAnimating()&&(this._animation._animation.onfinish=null),this._isActive=!0,this._animOptions.easing=m,this._animOptions.duration=h,this._isInterrupted=u,a=n._id,c=this._setupAnimation,l=this._startAnimation,i.add(0,Et+a,c),i.add(2,xt+a,l)}},w.prototype.stop=function(e,t,n){if(!this._isDestroyed&&this._isActive){var o,s=this._item;(Qe(s._id),this._animation.isAnimating())&&((void 0===t||void 0===n)&&(o=y(s._element),t=o.x,n=o.y),s._setTranslate(t,n),this._animation.stop()),r(s._element,s.getGrid()._settings.itemPositioningClass),this._isActive=!1,e&&s._emitter.burst(this._queue,!0,s)}},w.prototype.destroy=function(){if(!this._isDestroyed){var e=this._item._element.style;this.stop(!0,0,0),this._item._emitter.clear(this._queue),this._animation.destroy(),e[v]="",e.left="",e.top="",this._item=null,this._currentStyles=null,this._targetStyles=null,this._animOptions=null,this._isDestroyed=!0}},w.prototype._updateOffsets=function(){if(!this._isDestroyed){var n=this._item,e=n._migrate,t=n._dragRelease;this._offsetLeft=t._isActive?t._containerDiffX:e._isActive?e._containerDiffX:0,this._offsetTop=t._isActive?t._containerDiffY:e._isActive?e._containerDiffY:0,this._nextLeft=this._item._left+this._offsetLeft,this._nextTop=this._item._top+this._offsetTop}},w.prototype._finish=function(){if(!this._isDestroyed){var e=this._item,t=e._migrate,n=e._dragRelease;e._tX=this._nextLeft,e._tY=this._nextTop,this._isActive&&(this._isActive=!1,r(e._element,e.getGrid()._settings.itemPositioningClass)),n._isActive&&n.stop(),t._isActive&&t.stop(),e._emitter.burst(this._queue,!1,e)}},w.prototype._setupAnimation=function(){var t,e=this._item;(void 0===e._tX||void 0===e._tY)&&(t=y(e._element),e._tX=t.x,e._tY=t.y)},w.prototype._startAnimation=function(){var t,n,e=this._item,s=e.getGrid()._settings,o=this._animOptions.duration<=0;if(this._updateOffsets(),t=Math.abs(e._left-(e._tX-this._offsetLeft)),n=Math.abs(e._top-(e._tY-this._offsetTop)),o||t<2&&n<2)return(t||n||this._isInterrupted)&&e._setTranslate(this._nextLeft,this._nextTop),this._animation.stop(),void this._finish();this._isInterrupted||d(e._element,s.itemPositioningClass),this._currentStyles[v]=C(e._tX,e._tY),this._targetStyles[v]=C(this._nextLeft,this._nextTop),e._tX=e._tY=void 0,this._animation.start(this._currentStyles,this._targetStyles,this._animOptions)},Z.prototype.start=function(e,n,s){if(!this._isDestroyed){var c,l,h,m,b,j,O,C,k,A,o=this._item,a=o._element,_=o.isActive(),w=o.isVisible(),i=o.getGrid(),g=i._settings,u=e._settings,x=e._element,v=e._items,p=i._items.indexOf(o),f=s||document.body;if("number"==typeof n)h=L(v,n,1);else{if(!(C=e.getItem(n)))return;h=v.indexOf(C)}(o.isPositioning()||this._isActive||o.isReleasing())&&(l=(m=y(a)).x,c=m.y),o.isPositioning()&&o._layout.stop(!0,l,c),this._isActive&&(l-=this._containerDiffX,c-=this._containerDiffY,this.stop(!0,l,c)),o.isReleasing()&&(l-=o._dragRelease._containerDiffX,c-=o._dragRelease._containerDiffY,o._dragRelease.stop(!0,l,c)),o._visibility.stop(!0),o._drag&&o._drag.destroy(),i._hasListeners(E)&&i._emit(E,{item:o,fromGrid:i,fromIndex:p,toGrid:e,toIndex:h}),e._hasListeners(ae)&&e._emit(ae,{item:o,fromGrid:i,fromIndex:p,toGrid:e,toIndex:h}),g.itemClass!==u.itemClass&&(r(a,g.itemClass),d(a,u.itemClass)),(k=w?g.itemVisibleClass:g.itemHiddenClass)!==(A=w?u.itemVisibleClass:u.itemHiddenClass)&&(r(a,k),d(a,A)),i._items.splice(p,1),Pe(v,o,h),o._gridId=e._id,_?f!==(O=a.parentNode)&&(f.appendChild(a),j=P(f,O,!0),m||(l=(m=y(a)).x,c=m.y),o._setTranslate(l+j.left,c+j.top)):x.appendChild(a),o._visibility.setStyles(w?u.visibleStyles:u.hiddenStyles),_&&(b=P(f,x,!0)),o._refreshDimensions(),o._sortData=null,o._drag=u.dragEnabled?new t(o):null,_?(this._isActive=!0,this._container=f,this._containerDiffX=b.left,this._containerDiffY=b.top):(this._isActive=!1,this._container=null,this._containerDiffX=0,this._containerDiffY=0),i._hasListeners(se)&&i._emit(se,{item:o,fromGrid:i,fromIndex:p,toGrid:e,toIndex:h}),e._hasListeners(ee)&&e._emit(ee,{item:o,fromGrid:i,fromIndex:p,toGrid:e,toIndex:h})}},Z.prototype.stop=function(e,t,n){if(!this._isDestroyed&&this._isActive){var o,s=this._item,i=s._element,a=s.getGrid()._element;this._container!==a&&(void 0!==t&&void 0!==n||(e?(t=(o=y(i)).x-this._containerDiffX,n=o.y-this._containerDiffY):(t=s._left,n=s._top)),a.appendChild(i),s._setTranslate(t,n)),this._isActive=!1,this._container=null,this._containerDiffX=0,this._containerDiffY=0}},Z.prototype.destroy=function(){this._isDestroyed||(this.stop(!0),this._item=null,this._isDestroyed=!0)},f.prototype.show=function(e,t){if(!this._isDestroyed){var n=this._item,i=n._element,o=s(t)?t:null,a=n.getGrid()._settings;this._isShowing||this._isHidden?!this._isShowing||e?(this._isShowing||(n._emitter.burst(this._queue,!0,n),r(i,a.itemHiddenClass),d(i,a.itemVisibleClass),this._isHiding||(i.style.display="")),o&&n._emitter.on(this._queue,o),this._isShowing=!0,this._isHiding=this._isHidden=!1,this._startAnimation(!0,e,this._finishShow)):o&&n._emitter.on(this._queue,o):o&&o(!1,n)}},f.prototype.hide=function(e,t){if(!this._isDestroyed){var n=this._item,i=n._element,o=s(t)?t:null,a=n.getGrid()._settings;this._isHiding||!this._isHidden?!this._isHiding||e?(this._isHiding||(n._emitter.burst(this._queue,!0,n),d(i,a.itemHiddenClass),r(i,a.itemVisibleClass)),o&&n._emitter.on(this._queue,o),this._isHidden=this._isHiding=!0,this._isShowing=!1,this._startAnimation(!1,e,this._finishHide)):o&&n._emitter.on(this._queue,o):o&&o(!1,n)}},f.prototype.stop=function(e){if(!this._isDestroyed&&(this._isHiding||this._isShowing)){var t=this._item;Ze(t._id),this._animation.stop(),e&&t._emitter.burst(this._queue,!0,t)}},f.prototype.setStyles=function(e){var t,n=this._childElement,s=this._currentStyleProps;for(t in this._removeCurrentStyles(),e)s.push(t),n.style[t]=e[t]},f.prototype.destroy=function(){if(!this._isDestroyed){var e=this._item,t=e._element,n=e.getGrid()._settings;this.stop(!0),e._emitter.clear(this._queue),this._animation.destroy(),this._removeCurrentStyles(),r(t,n.itemVisibleClass),r(t,n.itemHiddenClass),t.style.display="",this._isHiding=this._isShowing=!1,this._isDestroyed=this._isHidden=!0}},f.prototype._startAnimation=function(e,t,n){if(!this._isDestroyed){var c,l,h,m,r=this._item,o=this._animation,d=this._childElement,s=r.getGrid()._settings,a=e?s.visibleStyles:s.hiddenStyles,u=e?s.showDuration:s.hideDuration,f=e?s.showEasing:s.hideEasing,p=t||u<=0;if(a){if(Ze(r._id),p)return I(d,a),o.stop(),void(n&&n());o.isAnimating()&&(o._animation.onfinish=null),c=r._id,h=function(){l=yt(d,a)},m=function(){o.start(l,a,{duration:u,easing:f,onFinish:n})},i.add(0,jt+c,h),i.add(2,bt+c,m)}else n&&n()}},f.prototype._finishShow=function(){this._isHidden||(this._isShowing=!1,this._item._emitter.burst(this._queue,!1,this._item))},f.prototype._finishHide=function(){if(this._isHidden){var e=this._item;this._isHiding=!1,e._layout.stop(!0,0,0),e._element.style.display="none",e._emitter.burst(this._queue,!1,e)}},f.prototype._removeCurrentStyles=function(){for(var n=this._childElement,e=this._currentStyleProps,t=0;t<e.length;t++)n.style[e[t]]="";e.length=0},Rt=0;function Pt(){return++Rt}function a(e,n,s){var o=e._settings;if(D){if(D.has(n))throw new Error("You can only create one Muuri Item per element!");D.set(n,this)}this._id=Pt(),this._gridId=e._id,this._element=n,this._isDestroyed=!1,this._left=0,this._top=0,this._width=0,this._height=0,this._marginLeft=0,this._marginRight=0,this._marginTop=0,this._marginBottom=0,this._tX=void 0,this._tY=void 0,this._sortData=null,this._emitter=new h,n.parentNode!==e._element&&e._element.appendChild(n),d(n,o.itemClass),"boolean"!=typeof s&&(s="none"!==l(n,"display")),this._isActive=s,this._visibility=new f(this),this._layout=new w(this),this._migrate=new Z(this),this._drag=o.dragEnabled?new t(this):null,this._dragRelease=new A(this),this._dragPlaceholder=new c(this)}function It(e){var s,i,a,r,c,d,t=.001,o=.5;function l(e){return((1e3*e+.5<<0)/10<<0)/100}function n(){this.currentRects=[],this.nextRects=[],this.rectTarget={},this.rectStore=[],this.slotSizes=[],this.rectId=0,this.slotIndex=-1,this.slotData={left:0,top:0,width:0,height:0},this.sortRectsLeftTop=this.sortRectsLeftTop.bind(this),this.sortRectsTopLeft=this.sortRectsTopLeft.bind(this)}return(n.prototype.computeLayout=function(e,t){var n,s,i,r,c,d,a=e.items,o=e.slots,p=!!(1&t),u=!!(2&t),h=!!(4&t),m=!!(8&t),g=!!(16&t),f="number"==typeof a[0];if(!a.length)return e;for(d=f?2:1,n=0;n<a.length;n+=d)f?(r=a[n],c=a[n+1]):(r=(i=a[n])._width+i._marginLeft+i._marginRight,c=i._height+i._marginTop+i._marginBottom),g&&(r=l(r),c=l(c)),s=this.computeNextSlot(e,r,c,p,u),u?s.left+s.width>e.width&&(e.width=s.left+s.width):s.top+s.height>e.height&&(e.height=s.top+s.height),o[++this.slotIndex]=s.left,o[++this.slotIndex]=s.top,(h||m)&&this.slotSizes.push(s.width,s.height);if(h)for(n=0;n<o.length;n+=2)o[n]=e.width-(o[n]+this.slotSizes[n]);if(m)for(n=1;n<o.length;n+=2)o[n]=e.height-(o[n]+this.slotSizes[n]);return this.slotSizes.length=0,this.currentRects.length=0,this.nextRects.length=0,this.rectStore.length=0,this.rectId=0,this.slotIndex=-1,e},n.prototype.computeNextSlot=function(e,n,s,i,a){var c,d,u,m,f,r=this.slotData,h=this.currentRects,l=this.nextRects,p=!1;for(l.length=0,r.left=null,r.top=null,r.width=n,r.height=s,d=0;d<h.length;d++)if((u=h[d])&&(c=this.getRect(u),r.width<=c.width+t&&r.height<=c.height+t)){r.left=c.left,r.top=c.top;break}if(null===r.left&&(a?(r.left=e.width,r.top=0):(r.left=0,r.top=e.height),i||(p=!0)),!a&&r.top+r.height>e.height+t&&(r.left>o&&l.push(this.addRect(0,e.height,r.left,1/0)),r.left+r.width<e.width-o&&l.push(this.addRect(r.left+r.width,e.height,e.width-r.left-r.width,1/0)),e.height=r.top+r.height),a&&r.left+r.width>e.width+t&&(r.top>o&&l.push(this.addRect(e.width,0,1/0,r.top)),r.top+r.height<e.height-o&&l.push(this.addRect(e.width,r.top+r.height,1/0,e.height-r.top-r.height)),e.width=r.left+r.width),!p)for(i&&(d=0);d<h.length;d++)if(u=h[d])for(c=this.getRect(u),f=this.splitRect(c,r),m=0;m<f.length;m++)u=f[m],c=this.getRect(u),(a?c.left+t<e.width-t:c.top+t<e.height-t)&&l.push(u);return l.length>1&&this.purgeRects(l).sort(a?this.sortRectsLeftTop:this.sortRectsTopLeft),this.currentRects=l,this.nextRects=h,r},n.prototype.addRect=function(e,t,n,s){var o=++this.rectId;return this.rectStore[o]=e||0,this.rectStore[++this.rectId]=t||0,this.rectStore[++this.rectId]=n||0,this.rectStore[++this.rectId]=s||0,o},n.prototype.getRect=function(e,t){return t||(t=this.rectTarget),t.left=this.rectStore[e]||0,t.top=this.rectStore[++e]||0,t.width=this.rectStore[++e]||0,t.height=this.rectStore[++e]||0,t},n.prototype.splitRect=(s=[],i=0,a=0,function(e,n){return s.length=0,e.left+e.width<=n.left+t||n.left+n.width<=e.left+t||e.top+e.height<=n.top+t||n.top+n.height<=e.top+t?(s.push(this.addRect(e.left,e.top,e.width,e.height)),s):((i=n.left-e.left)>=o&&s.push(this.addRect(e.left,e.top,i,e.height)),(i=e.left+e.width-(n.left+n.width))>=o&&s.push(this.addRect(n.left+n.width,e.top,i,e.height)),(a=n.top-e.top)>=o&&s.push(this.addRect(e.left,e.top,e.width,a)),(a=e.top+e.height-(n.top+n.height))>=o&&s.push(this.addRect(e.left,n.top+n.height,e.width,a)),s)}),n.prototype.isRectAWithinRectB=function(e,n){return e.left+t>=n.left&&e.top+t>=n.top&&e.left+e.width-t<=n.left+n.width&&e.top+e.height-t<=n.top+n.height},n.prototype.purgeRects=(r={},c={},function(e){for(var t,n=e.length;n--;)if(t=e.length,e[n])for(this.getRect(e[n],r);t--;)if(e[t]&&n!==t&&(this.getRect(e[t],c),this.isRectAWithinRectB(r,c))){e[n]=0;break}return e}),n.prototype.sortRectsTopLeft=function(){var e={},n={};return function(s,o){return this.getRect(s,e),this.getRect(o,n),e.top<n.top&&e.top+t<n.top?-1:e.top>n.top&&e.top-t>n.top?1:e.left<n.left&&e.left+t<n.left?-1:e.left>n.left&&e.left-t>n.left?1:0}}(),n.prototype.sortRectsLeftTop=function(){var e={},n={};return function(s,o){return this.getRect(s,e),this.getRect(o,n),e.left<n.left&&e.left+t<n.left?-1:e.left>n.left&&e.left-t<n.left?1:e.top<n.top&&e.top+t<n.top?-1:e.top>n.top&&e.top-t>n.top?1:0}}(),e)&&(d=new n,self.onmessage=function(e){var t=new Float32Array(e.data),s=t.subarray(4,t.length),o=new Float32Array(s.length),i=t[3],n={items:s,slots:o,width:t[1],height:t[2]};d.computeLayout(n,i),t[1]=n.width,t[2]=n.height,t.set(n.slots,4),postMessage(t.buffer,[t.buffer])}),n}a.prototype.getGrid=function(){return de[this._gridId]},a.prototype.getElement=function(){return this._element},a.prototype.getWidth=function(){return this._width},a.prototype.getHeight=function(){return this._height},a.prototype.getMargin=function(){return{left:this._marginLeft,right:this._marginRight,top:this._marginTop,bottom:this._marginBottom}},a.prototype.getPosition=function(){return{left:this._left,top:this._top}},a.prototype.isActive=function(){return this._isActive},a.prototype.isVisible=function(){return!!this._visibility&&!this._visibility._isHidden},a.prototype.isShowing=function(){return!!this._visibility&&!!this._visibility._isShowing},a.prototype.isHiding=function(){return!!this._visibility&&!!this._visibility._isHiding},a.prototype.isPositioning=function(){return!!this._layout&&!!this._layout._isActive},a.prototype.isDragging=function(){return!!this._drag&&!!this._drag._isActive},a.prototype.isReleasing=function(){return!!this._dragRelease&&!!this._dragRelease._isActive},a.prototype.isDestroyed=function(){return this._isDestroyed},a.prototype._refreshDimensions=function(e){if(!(this._isDestroyed||!0!==e&&this._visibility._isHidden)){var t=this._element,n=this._dragPlaceholder,s=t.getBoundingClientRect();this._width=s.width,this._height=s.height,this._marginLeft=Math.max(0,u(t,"margin-left")),this._marginRight=Math.max(0,u(t,"margin-right")),this._marginTop=Math.max(0,u(t,"margin-top")),this._marginBottom=Math.max(0,u(t,"margin-bottom")),n&&n.updateDimensions()}},a.prototype._refreshSortData=function(){if(!this._isDestroyed){var e,n=this._sortData={},t=this.getGrid()._settings.sortData;for(e in t)n[e]=t[e](this,this._element)}},a.prototype._addToLayout=function(e,t){!0!==this._isActive&&(this._isActive=!0,this._left=e||0,this._top=t||0)},a.prototype._removeFromLayout=function(){!1!==this._isActive&&(this._isActive=!1,this._left=0,this._top=0)},a.prototype._canSkipLayout=function(e,t){return this._left===e&&this._top===t&&!this._migrate._isActive&&!this._layout._skipNextAnimation&&!this._dragRelease.isJustReleased()},a.prototype._setTranslate=function(e,t){return(this._tX!==e||this._tY!==t)&&(this._tX=e,this._tY=t,this._element.style[v]=C(e,t),!0)},a.prototype._destroy=function(e){if(!this._isDestroyed){var t=this._element,n=this.getGrid()._settings;this._dragPlaceholder.destroy(),this._dragRelease.destroy(),this._migrate.destroy(),this._layout.destroy(),this._visibility.destroy(),this._drag&&this._drag.destroy(),this._emitter.destroy(),r(t,n.itemClass),e&&t.parentNode.removeChild(t),D&&D.delete(t),this._isActive=!1,this._isDestroyed=!0}};var Bt=It(),R=null,re=[];function j(e,t){if(this._options=0,this._processor=null,this._layoutQueue=[],this._layouts={},this._layoutCallbacks={},this._layoutWorkers={},this._layoutWorkerData={},this._workers=[],this._onWorkerMessage=this._onWorkerMessage.bind(this),this.setOptions(t),(e="number"==typeof e?Math.max(0,e):0)&&window.Worker&&window.URL&&window.Blob)try{this._workers=function(e,t){var n,s,o=[];if(e>0){R||(R=URL.createObjectURL(new Blob(["("+It.toString()+")(true)"],{type:"application/javascript"})));for(s=0;s<e;s++)n=new Worker(R),t&&(n.onmessage=t),o.push(n),re.push(n)}return o}(e,this._onWorkerMessage)}catch{this._processor=new Bt}else this._processor=new Bt}j.prototype._sendToWorker=function(){if(this._layoutQueue.length&&this._workers.length){var e=this._layoutQueue.shift(),t=this._workers.pop(),n=this._layoutWorkerData[e];delete this._layoutWorkerData[e],this._layoutWorkers[e]=t,t.postMessage(n.buffer,[n.buffer])}},j.prototype._onWorkerMessage=function(e){var s=new Float32Array(e.data),n=s[0],t=this._layouts[n],o=this._layoutCallbacks[n],i=this._layoutWorkers[n];t&&delete this._layouts[n],o&&delete this._layoutCallbacks[n],i&&delete this._layoutWorkers[n],t&&o&&(t.width=s[1],t.height=s[2],t.slots=s.subarray(4,s.length),this._finalizeLayout(t),o(t)),i&&(this._workers.push(i),this._sendToWorker())},j.prototype._finalizeLayout=function(e){var t=e._grid,s=2&e._settings,n="border-box"===t._boxSizing;return delete e._grid,delete e._settings,e.styles={},s?e.styles.width=(n?e.width+t._borderLeft+t._borderRight:e.width)+"px":e.styles.height=(n?e.height+t._borderTop+t._borderBottom:e.height)+"px",e},j.prototype.setOptions=function(e){var t,n,s,o,i;e&&(t="boolean"==typeof e.fillGaps?e.fillGaps?1:0:1&this._options,n="boolean"==typeof e.horizontal?e.horizontal?2:0:2&this._options,s="boolean"==typeof e.alignRight?e.alignRight?4:0:4&this._options,o="boolean"==typeof e.alignBottom?e.alignBottom?8:0:8&this._options,i="boolean"==typeof e.rounding?e.rounding?16:0:16&this._options,this._options=t|n|s|o|i)},j.prototype.createLayout=function(e,t,n,s,o,i){if(this._layouts[t])throw new Error("A layout with the provided id is currently being processed.");var r,c,l,d,u=2&this._options,a={id:t,items:n,slots:null,width:u?0:s,height:u?o:0,_grid:e,_settings:this._options};if(!n.length)return a.slots=[],this._finalizeLayout(a),void i(a);if(this._processor)return a.slots=window.Float32Array?new Float32Array(2*n.length):new Array(2*n.length),this._processor.computeLayout(a,a._settings),this._finalizeLayout(a),void i(a);r=new Float32Array(4+2*n.length);for(r[0]=t,r[1]=a.width,r[2]=a.height,r[3]=a._settings,l=0,d=3;l<n.length;l++)c=n[l],r[++d]=c._width+c._marginLeft+c._marginRight,r[++d]=c._height+c._marginTop+c._marginBottom;return this._layoutQueue.push(t),this._layouts[t]=a,this._layoutCallbacks[t]=i,this._layoutWorkerData[t]=r,this._sendToWorker(),this.cancelLayout.bind(this,t)},j.prototype.cancelLayout=function(e){if(this._layouts[e]&&(delete this._layouts[e],delete this._layoutCallbacks[e],this._layoutWorkerData[e])){delete this._layoutWorkerData[e];var t=this._layoutQueue.indexOf(e);t>-1&&this._layoutQueue.splice(t,1)}},j.prototype.destroy=function(){for(var e in this._layoutWorkers)this._workers.push(this._layoutWorkers[e]);!function(e){for(var t,s,n=0;n<e.length;n++)(t=e[n]).onmessage=null,t.onerror=null,t.onmessageerror=null,t.terminate(),(s=re.indexOf(t))>-1&&re.splice(s,1);R&&!re.length&&(URL.revokeObjectURL(R),R=null)}(this._workers),this._workers.length=0,this._layoutQueue.length=0,this._layouts={},this._layoutCallbacks={},this._layoutWorkers={},this._layoutWorkerData={}},Dt=0;function Jt(e,t){var r=++Dt,n=0,s=0,o=!1,a=function(t){o||(s&&(n-=t-s),s=t,n>0?function(e,t){i.add(0,Ye+e,t)}(r,a):(n=s=0,e()))};return function(c){if(!o){if(!(t<=0))return!0===c?(o=!0,n=s=0,a=void 0,void function(e){i.remove(0,Ye+e)}(r)):void(n<=0?(n=t,a(0)):n=t);!0!==c&&e()}}}function _e(e){var t=Object.prototype.toString.call(e);return"[object HTMLCollection]"===t||"[object NodeList]"===t}zt=Object.prototype.toString;function At(e){return"object"==typeof e&&"[object Object]"===zt.call(e)}function Xt(){}var F,dt="number",oe="string",k="instant",rt=0;function n(e,t){if(typeof e===oe&&(e=document.querySelector(e)),!(e.getRootNode?e.getRootNode({composed:!0})===document:document.body.contains(e))||e===document.documentElement)throw new Error("Container element must be an existing DOM element.");var o=function(e,t){var n=G({},e);return t&&(n=G(n,t)),t&&t.visibleStyles?n.visibleStyles=t.visibleStyles:e&&e.visibleStyles&&(n.visibleStyles=e.visibleStyles),t&&t.hiddenStyles?n.hiddenStyles=t.hiddenStyles:e&&e.hiddenStyles&&(n.hiddenStyles=e.hiddenStyles),n}(n.defaultOptions,t);o.visibleStyles=qe(o.visibleStyles),o.hiddenStyles=qe(o.hiddenStyles),s(o.dragSort)||(o.dragSort=!!o.dragSort),this._id=Pt(),this._element=e,this._settings=o,this._isDestroyed=!1,this._items=[],this._layout={id:0,items:[],slots:[]},this._isLayoutFinished=!0,this._nextLayoutData=null,this._emitter=new h,this._onLayoutDataReceived=this._onLayoutDataReceived.bind(this),de[this._id]=this,d(e,o.containerClass),function(e,t){typeof t!==dt&&(t=!0===t?0:-1),t>=0&&(e._resizeHandler=Jt(function(){e.refreshItems().layout()},t),window.addEventListener("resize",e._resizeHandler))}(this,o.layoutOnResize),this.add(function(e,t){if("*"===t)return e.children;if(typeof t===oe){for(var o=[],s=e.children,n=0;n<s.length;n++)te(s[n],t)&&o.push(s[n]);return o}return Array.isArray(t)||_e(t)?t:[]}(e,o.items),{layout:!1}),o.layoutOnInit&&this.layout(!0)}function G(e,t){var n,s,o,i=Object.keys(t),a=i.length;for(s=0;s<a;s++)o=At(t[n=i[s]]),At(e[n])&&o?e[n]=G(G({},e[n]),t[n]):o?e[n]=G({},t[n]):Array.isArray(t[n])?e[n]=t[n].slice(0):e[n]=t[n];return e}function qe(e){var t,n,s={},o=document.documentElement.style;for(t in e)e[t]&&(n=pe(o,t))&&(s[n]=e[t]);return s}function Ke(e){for(var n={},t=0;t<e.length;t++)n[e[t]._id]=t;return n}function me(e,t,n){return e[t._id]-e[n._id]}return n.Item=a,n.ItemLayout=w,n.ItemVisibility=f,n.ItemMigrate=Z,n.ItemDrag=t,n.ItemDragRelease=A,n.ItemDragPlaceholder=c,n.Emitter=h,n.Animator=g,n.Dragger=e,n.Packer=j,n.AutoScroller=o,n.defaultPacker=new j(2),n.defaultOptions={items:"*",showDuration:300,showEasing:"ease",hideDuration:300,hideEasing:"ease",visibleStyles:{opacity:"1",transform:"scale(1)"},hiddenStyles:{opacity:"0",transform:"scale(0.5)"},layout:{fillGaps:!1,horizontal:!1,alignRight:!1,alignBottom:!1,rounding:!1},layoutOnResize:150,layoutOnInit:!0,layoutDuration:300,layoutEasing:"ease",sortData:null,dragEnabled:!1,dragContainer:null,dragHandle:null,dragStartPredicate:{distance:0,delay:0},dragAxis:"xy",dragSort:!0,dragSortHeuristics:{sortInterval:100,minDragDistance:10,minBounceBackAngle:1},dragSortPredicate:{threshold:50,action:N,migrateAction:N},dragRelease:{duration:300,easing:"ease",useDragContainer:!0},dragCssProps:{touchAction:"none",userSelect:"none",userDrag:"none",tapHighlightColor:"rgba(0, 0, 0, 0)",touchCallout:"none",contentZooming:"none"},dragPlaceholder:{enabled:!1,createElement:null,onCreate:null,onRemove:null},dragAutoScroll:{targets:[],handle:null,threshold:50,safeZone:.2,speed:o.smoothSpeed(1e3,2e3,2500),sortDuringScroll:!0,smoothStop:!1,onStart:null,onStop:null},containerClass:"muuri",itemClass:"muuri-item",itemVisibleClass:"muuri-item-shown",itemHiddenClass:"muuri-item-hidden",itemPositioningClass:"muuri-item-positioning",itemDraggingClass:"muuri-item-dragging",itemReleasingClass:"muuri-item-releasing",itemPlaceholderClass:"muuri-item-placeholder"},n.prototype.on=function(e,t){return this._emitter.on(e,t),this},n.prototype.off=function(e,t){return this._emitter.off(e,t),this},n.prototype.getElement=function(){return this._element},n.prototype.getItem=function(e){if(this._isDestroyed||!e&&0!==e)return null;if(typeof e===dt)return this._items[e>-1?e:this._items.length+e]||null;if(e instanceof a)return e._gridId===this._id?e:null;if(D){var t,n=D.get(e);return n&&n._gridId===this._id?n:null}for(t=0;t<this._items.length;t++)if(this._items[t]._element===e)return this._items[t];return null},n.prototype.getItems=function(e){if(this._isDestroyed||void 0===e)return this._items.slice(0);var t,n,s=[];if(Array.isArray(e)||_e(e))for(t=0;t<e.length;t++)(n=this.getItem(e[t]))&&s.push(n);else(n=this.getItem(e))&&s.push(n);return s},n.prototype.refreshItems=function(e,t){if(this._isDestroyed)return this;var n,s,o,a,i=e||this._items;if(!0===t)for(o=[],n=0;n<i.length;n++)(a=i[n]).isVisible()||a.isHiding()||((s=a.getElement().style).visibility="hidden",s.display="",o.push(s));for(n=0;n<i.length;n++)i[n]._refreshDimensions(t);if(!0===t){for(n=0;n<o.length;n++)(s=o[n]).visibility="",s.display="none";o.length=0}return this},n.prototype.refreshSortData=function(e){if(this._isDestroyed)return this;for(var n=e||this._items,t=0;t<n.length;t++)n[t]._refreshSortData();return this},n.prototype.synchronize=function(){if(this._isDestroyed)return this;var e,t,s,n=this._items;if(!n.length)return this;for(t=0;t<n.length;t++)(s=n[t]._element).parentNode===this._element&&(e=e||document.createDocumentFragment()).appendChild(s);return e?(this._element.appendChild(e),this._emit("synchronize"),this):this},n.prototype.layout=function(e,t){if(this._isDestroyed)return this;i=this._nextLayoutData,i&&s(i.cancel)&&i.cancel(),o=rt=rt%16777216+1,this._nextLayoutData={id:o,instant:e,onFinish:t,cancel:null};for(var o,i,c=this._items,l=[],a=0;a<c.length;a++)c[a]._isActive&&l.push(c[a]);this._refreshDimensions();var r,u=this._width-this._borderLeft-this._borderRight,h=this._height-this._borderTop-this._borderBottom,d=this._settings.layout;return s(d)?r=d(this,o,l,u,h,this._onLayoutDataReceived):(n.defaultPacker.setOptions(d),r=n.defaultPacker.createLayout(this,o,l,u,h,this._onLayoutDataReceived)),s(r)&&this._nextLayoutData&&this._nextLayoutData.id===o&&(this._nextLayoutData.cancel=r),this},n.prototype.add=function(e,t){if(this._isDestroyed||!e)return[];if(n=_e(u=e)?Array.prototype.slice.call(u):Array.prototype.concat(u),!n.length)return n;var n,o,r,c,l,u,i=t||{},d=i.layout?i.layout:void 0===i.layout,m=this._items,h=!1;for(o=0;o<n.length;o++)(c=n[o]).parentNode!==this._element&&(r=r||document.createDocumentFragment()).appendChild(c);for(r&&this._element.appendChild(r),o=0;o<n.length;o++)c=n[o],(l=n[o]=new a(this,c,i.active))._isActive&&(h=!0,l._layout._skipNextAnimation=!0);for(o=0;o<n.length;o++)(l=n[o])._refreshDimensions(),l._refreshSortData();return Pe(m,n,i.index),this._hasListeners("add")&&this._emit("add",n.slice(0)),h&&d&&this.layout(d===k,s(d)?d:void 0),n},n.prototype.remove=function(e,t){if(this._isDestroyed||!e.length)return[];var n,o,c,i=t||{},a=i.layout?i.layout:void 0===i.layout,l=!1,u=this.getItems(),r=[],d=[];for(o=0;o<e.length;o++)(n=e[o])._isDestroyed||-1!==(c=this._items.indexOf(n))&&(n._isActive&&(l=!0),r.push(n),d.push(u.indexOf(n)),n._destroy(i.removeElements),this._items.splice(c,1));return this._hasListeners(ot)&&this._emit(ot,r.slice(0),d),l&&a&&this.layout(a===k,s(a)?a:void 0),r},n.prototype.show=function(e,t){return!this._isDestroyed&&e.length&&this._setItemsVisibility(e,!0,t),this},n.prototype.hide=function(e,t){return!this._isDestroyed&&e.length&&this._setItemsVisibility(e,!1,t),this},n.prototype.filter=function(e,t){if(this._isDestroyed||!this._items.length)return this;var a,c,i=[],o=[],f=typeof e===oe,d=s(e),n=t||{},u=!0===n.instant,h=n.syncWithLayout,l=n.layout?n.layout:void 0===n.layout,m=s(n.onFinish)?n.onFinish:null,p=-1,r=Xt;if(m&&(r=function(){++p&&m(i.slice(0),o.slice(0))}),d||f)for(c=0;c<this._items.length;c++)a=this._items[c],(d?e(a):te(a._element,e))?i.push(a):o.push(a);return i.length?this.show(i,{instant:u,syncWithLayout:h,onFinish:r,layout:!1}):r(),o.length?this.hide(o,{instant:u,syncWithLayout:h,onFinish:r,layout:!1}):r(),(i.length||o.length)&&(this._hasListeners(ct)&&this._emit(ct,i.slice(0),o.slice(0)),l&&this.layout(l===k,s(l)?l:void 0)),this},n.prototype.sort=function(){var e,t,n,o;function i(s,i){for(var a,r,d,u,c=0,l=0;l<t.length;l++)if(d=t[l][0],u=t[l][1],a=(s._sortData?s:s._refreshSortData())._sortData[d],r=(i._sortData?i:i._refreshSortData())._sortData[d],c="desc"===u||!u&&n?r<a?-1:r>a?1:0:a<r?-1:a>r?1:0)return c;return c||(e||(e=Ke(o)),c=n?me(e,i,s):me(e,s,i)),c}function a(s,i){var a=n?-t(s,i):t(s,i);return a||(e||(e=Ke(o)),a=n?me(e,i,s):me(e,s,i)),a}return function(r,c){if(this._isDestroyed||this._items.length<2)return this;var l=this._items,d=c||{},u=d.layout?d.layout:void 0===d.layout;if(n=!!d.descending,o=l.slice(0),e=null,s(r))t=r,l.sort(a);else if(typeof r===oe)t=r.trim().split(" ").filter(function(e){return e}).map(function(e){return e.split(":")}),l.sort(i);else{if(!Array.isArray(r))throw t=n=o=e=null,new Error("Invalid comparer argument provided.");l.length=0,l.push.apply(l,r)}return this._hasListeners(lt)&&this._emit(lt,l.slice(0),o),u&&this.layout(u===k,s(u)?u:void 0),t=n=o=e=null,this}}(),n.prototype.move=function(e,t,n){if(this._isDestroyed||this._items.length<2)return this;var o,i,a=this._items,r=n||{},c=r.layout?r.layout:void 0===r.layout,u=r.action===b,h=u?b:N,l=this.getItem(e),d=this.getItem(t);return l&&d&&l!==d&&(o=a.indexOf(l),i=a.indexOf(d),u?$e(a,o,i):Ve(a,o,i),this._hasListeners(ne)&&this._emit(ne,{item:l,fromIndex:o,toIndex:i,action:h}),c&&this.layout(c===k,s(c)?c:void 0)),this},n.prototype.send=function(e,t,n,o){if(this._isDestroyed||t._isDestroyed||this===t)return this;if(!(e=this.getItem(e)))return this;var i=o||{},c=i.appendTo||document.body,a=i.layoutSender?i.layoutSender:void 0===i.layoutSender,r=i.layoutReceiver?i.layoutReceiver:void 0===i.layoutReceiver;return e._migrate.start(t,n,c),e._migrate._isActive&&e._isActive&&(a&&this.layout(a===k,s(a)?a:void 0),r&&t.layout(r===k,s(r)?r:void 0)),this},n.prototype.destroy=function(e){if(this._isDestroyed)return this;var t,n,s,o=this._element,i=this._items.slice(0),a=this._layout&&this._layout.styles||{};for((n=this)._resizeHandler&&(n._resizeHandler(!0),window.removeEventListener("resize",n._resizeHandler),n._resizeHandler=null),t=0;t<i.length;t++)i[t]._destroy(e);for(s in this._items.length=0,r(o,this._settings.containerClass),a)o.style[s]="";return this._emit("destroy"),this._emitter.destroy(),delete de[this._id],this._isDestroyed=!0,this},n.prototype._emit=function(){this._isDestroyed||this._emitter.emit.apply(this._emitter,arguments)},n.prototype._hasListeners=function(e){return!this._isDestroyed&&this._emitter.countListeners(e)>0},n.prototype._updateBoundingRect=function(){var e=this._element.getBoundingClientRect();this._width=e.width,this._height=e.height,this._left=e.left,this._top=e.top,this._right=e.right,this._bottom=e.bottom},n.prototype._updateBorders=function(e,t,n,s){var o=this._element;e&&(this._borderLeft=u(o,"border-left-width")),t&&(this._borderRight=u(o,"border-right-width")),n&&(this._borderTop=u(o,"border-top-width")),s&&(this._borderBottom=u(o,"border-bottom-width"))},n.prototype._refreshDimensions=function(){this._updateBoundingRect(),this._updateBorders(1,1,1,1),this._boxSizing=l(this._element,"box-sizing")},n.prototype._onLayoutDataReceived=(F=[],function(e){if(!this._isDestroyed&&this._nextLayoutData&&this._nextLayoutData.id===e.id){var t,n,r,c,l,o=this,i=this._nextLayoutData.instant,u=this._nextLayoutData.onFinish,d=e.items.length,a=d;for(this._nextLayoutData=null,!this._isLayoutFinished&&this._hasListeners(Xe)&&this._emit(Xe,this._layout.items.slice(0)),this._layout=e,F.length=0,t=0;t<d;t++)(n=e.items[t])?(r=e.slots[2*t],c=e.slots[2*t+1],n._canSkipLayout(r,c)?--a:(n._left=r,n._top=c,n.isActive()&&!n.isDragging()?F.push(n):--a)):--a;if(e.styles&&I(this._element,e.styles),!this._hasListeners(M)||(this._emit(M,e.items.slice(0),!0===i),this._layout.id===e.id)){if(l=function(){if(!(--a>0)){var t=o._layout.id!==e.id,n=s(i)?i:u;t||(o._isLayoutFinished=!0),s(n)&&n(e.items.slice(0),t),!t&&o._hasListeners(Ue)&&o._emit(Ue,e.items.slice(0))}},!F.length)return l(),this;for(this._isLayoutFinished=!1,t=0;t<F.length&&this._layout.id===e.id;t++)F[t]._layout.start(!0===i,l);return this._layout.id===e.id&&(F.length=0),this}}}),n.prototype._setItemsVisibility=function(e,t,n){var o,i,a=this,r=e.slice(0),c=n||{},j=!0===c.instant,l=c.onFinish,m=c.layout?c.layout:void 0===c.layout,p=r.length,v=t?"showStart":$,h=t?"showEnd":"hideEnd",b=t?"show":"hide",u=!1,d=[],f=[];if(p){for(i=0;i<r.length;i++)o=r[i],(t&&!o._isActive||!t&&o._isActive)&&(u=!0),o._layout._skipNextAnimation=!!t&&!o._isActive,t&&o._visibility._isHidden&&f.push(o),t?o._addToLayout():o._removeFromLayout();f.length&&(this.refreshItems(f,!0),f.length=0),u&&!1!==c.syncWithLayout?this.on(M,g):g(),u&&m&&this.layout(m===k,s(m)?m:void 0)}else s(l)&&l(r);function g(){for(u&&!1!==c.syncWithLayout&&a.off(M,g),a._hasListeners(v)&&a._emit(v,r.slice(0)),i=0;i<r.length;i++)r[i]._gridId===a._id?r[i]._visibility[b](j,function(e,t){e||d.push(t),--p<1&&(s(l)&&l(d.slice(0)),a._hasListeners(h)&&a._emit(h,d.slice(0)))}):--p<1&&(s(l)&&l(d.slice(0)),a._hasListeners(h)&&a._emit(h,d.slice(0)))}},n});const options={items:".item, .permanent",showDuration:700,showEasing:"cubic-bezier(0.215, 0.61, 0.355, 1)",hideDuration:700,hideEasing:"cubic-bezier(0.215, 0.61, 0.355, 1)",visibleStyles:{opacity:"1",transform:"scale(1)"},hiddenStyles:{opacity:"0",transform:"scale(0.01)"},layout:{fillGaps:!0,horizontal:!1,alignRight:!1,alignBottom:!1,rounding:!1},layoutOnResize:150,layoutOnInit:!0,layoutDuration:300,layoutEasing:"cubic-bezier(0.215, 0.61, 0.355, 1)",sortData:null,dragEnabled:!1,containerClass:"muuri",itemClass:"muuri-item",itemVisibleClass:"muuri-item-shown",itemHiddenClass:"muuri-item-hidden",itemPositioningClass:"muuri-item-positioning",itemDraggingClass:"muuri-item-dragging",itemReleasingClass:"muuri-item-releasing",itemPlaceholderClass:"muuri-item-placeholder"};if(document.getElementsByClassName("muugrid")){var muugrid=new Muuri(".muugrid",options),searchField,searchFieldValue,itemz,hidItems,filt;resizedw()}searchField=document.querySelector(".search-field"),itemz=document.querySelector(".item, .permanent"),searchField&&(searchField.value=""),searchField&&searchField.addEventListener("keyup",function(){var e=searchField.value.toLowerCase();searchFieldValue!==e&&(searchFieldValue=e,filter())});function tagfilter(e){var t=e.toLowerCase();searchFieldValue!==t&&(searchFieldValue=t,filter())}function filter(){muugrid.filter(function(e){var t=e.getElement(),n=!searchFieldValue||(t.getAttribute("data-search")||"").toLowerCase().indexOf(searchFieldValue)>-1;return n}),showPic()}hidItems=muugrid.on("hideStart",function(e){var n,t=[];for(let s=0;s<e.length;s++)n=e[s]._element.classList,Object.values(n).indexOf("permanent")>-1&&t.push(muugrid.getItem(e[s]));muugrid.show(t,{instant:!0})}),location.href.indexOf("#")!=-1&&(filt=window.location.hash,filt="."+filt.substring(1),filt=="."?muugrid.filter("*"):muugrid.filter(filt));function menuFilter(e){e=="."?muugrid.filter("*"):muugrid.filter(e);var t=e.substring(1);window.location.hash=t,document.getElementById("navbox-btn").classList.toggle("open"),document.getElementById("target").classList.toggle("hidden"),showPic()}